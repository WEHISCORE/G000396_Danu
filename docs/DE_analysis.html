<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>G000396: Untitled</title>




  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="G000396: Untitled"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="G000396"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="G000396: Untitled"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{},"value":[]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
    font-size: 100%;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  hr.section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    margin: 0px;
  }


  d-byline {
    border-top: none;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
    border-top: none;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  /* tweak for Pandoc numbered line within distill */
  d-article pre.numberSource code > span {
      left: -2em;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // separator
    var separator = '<hr class="section-separator" style="clear: both"/>';
    // prepend separator above appendix
    $('.d-byline').before(separator);
    $('.d-article').before(separator);

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme, except when numbering line
    // in code chunk
    $('pre:not(.numberLines) code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        var author_name = front_matter.authors[i].author
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        const citeChild = $(this).children()[0]
        // Do not process if @xyz has been used without escaping and without bibliography activated
        // https://github.com/rstudio/distill/issues/466
        if (citeChild === undefined) return true

        if (citeChild.nodeName == "D-FOOTNOTE") {
          var fn = citeChild
          $(this).html(fn.shadowRoot.querySelector("sup"))
          $(this).id = fn.id
          fn.remove()
        }
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          // Could use CSS.escape too here, we insure backward compatibility in navigator
          return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // fix footnotes in tables (#411)
      // replacing broken distill.pub feature
      $('table d-footnote').each(function() {
        // we replace internal showAtNode methode which is triggered when hovering a footnote
        this.hoverBox.showAtNode = function(node) {
          // ported from https://github.com/distillpub/template/pull/105/files
          calcOffset = function(elem) {
              let x = elem.offsetLeft;
              let y = elem.offsetTop;
              // Traverse upwards until an `absolute` element is found or `elem`
              // becomes null.
              while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                  x += elem.offsetLeft;
                  y += elem.offsetTop;
              }

              return { left: x, top: y };
          }
          // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
          const bbox = node.getBoundingClientRect();
          const offset = calcOffset(node);
          this.show([offset.left + bbox.width, offset.top + bbox.height]);
        }
      })

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      // ignore leaflet img layers (#106)
      figures = figures.filter(':not(img[class*="leaflet"])')
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Untitled","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">G000396</a>
<a href="index.html">Introduction</a>
<a href="G000396_Danu.preprocess.html">Preprocessing</a>
<a href="G000396_Danu.differential_expression.html">Differential expression</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Supplementary files
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../output/scPipe/">scPipe reports</a>
</div>
</div>
</div>
<div class="nav-right">
<a href="https://github.com/WEHISCORE/G000396_Danu">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>DE_analysis.R</h1>

<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  hickey
  
<br/>2025-02-27
</div>

<div class="d-article">
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># DE analysis of mini-bulk data for G000396_Danu</span></span>
<span><span class='co'># Peter Hickey</span></span>
<span><span class='co'># 2024-11-26</span></span>
<span></span>
<span><span class='co'># Setup ------------------------------------------------------------------------</span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://here.r-lib.org/'>here</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>SingleCellExperiment</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://bioinf.wehi.edu.au/edgeR/'>edgeR</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://wilkelab.org/cowplot/'>cowplot</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/slowkow/ggrepel'>ggrepel</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/hasaru-k/GlimmaV2'>Glimma</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>scuttle</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>splines</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>pheatmap</span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/rstudio/distill'>distill</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Take a DataFrame with AtomicList columns and return a data.frame where these</span></span>
<span><span class='co'># columns have been flattened by paste-ing together the elements separated by</span></span>
<span><span class='co'># `sep`.</span></span>
<span><span class='va'>flattenDF</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>sep</span> <span class='op'>=</span> <span class='st'>"; "</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span></span>
<span>    <span class='fu'>DataFrame</span><span class='op'>(</span></span>
<span>      <span class='fu'>endoapply</span><span class='op'>(</span><span class='va'>x</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>xx</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='kw'>if</span> <span class='op'>(</span><span class='op'>!</span><span class='fu'>is</span><span class='op'>(</span><span class='va'>xx</span>, <span class='st'>"list"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>          <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>xx</span><span class='op'>)</span></span>
<span>        <span class='op'>}</span></span>
<span>        <span class='fu'>unstrsplit</span><span class='op'>(</span><span class='fu'>as</span><span class='op'>(</span><span class='va'>xx</span>, <span class='st'>"CharacterList"</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='va'>sep</span><span class='op'>)</span></span>
<span>      <span class='op'>}</span><span class='op'>)</span>,</span>
<span>      row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># Load data --------------------------------------------------------------------</span></span>
<span></span>
<span><span class='va'>sce</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/readRDS.html'>readRDS</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"SCEs"</span>, <span class='st'>"G000396_Danu.preprocessed.SCE.rds"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># Define counts assay for use with edgeR::SE2DGEList()</span></span>
<span><span class='co'># NOTE: Using UMI counts results in a weird voom plot, notably an up-tick on</span></span>
<span><span class='co'>#       the right hand side of the voom plot.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/BiocGenerics/man/dge.html'>counts</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>assay</a></span><span class='op'>(</span><span class='va'>sce</span>, <span class='st'>"read_counts"</span><span class='op'>)</span></span>
<span><span class='co'># NOTE: Only retain relevant colData columns.</span></span>
<span><span class='va'>cd</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>colData</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html'>colData</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>cd</span><span class='op'>[</span></span>
<span>  ,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"cell_line"</span>, <span class='st'>"timepoint"</span>, <span class='st'>"biological_replicate"</span>, <span class='st'>"technical_replicate"</span>,</span>
<span>    <span class='st'>"sample"</span>, <span class='st'>"group"</span>, <span class='st'>"cell_line_rep"</span><span class='op'>)</span><span class='op'>]</span></span>
<span></span>
<span><span class='co'># Some useful colours</span></span>
<span><span class='co'># NOTE: First 5 colours are based on Set1</span></span>
<span><span class='va'>cell_line_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='st'>"GID1KO"</span> <span class='op'>=</span> <span class='st'>"#e41a1c"</span>,</span>
<span>  <span class='st'>"GID2KO"</span> <span class='op'>=</span> <span class='st'>"#377eb8"</span>,</span>
<span>  <span class='st'>"GID7KO"</span> <span class='op'>=</span> <span class='st'>"#4daf4a"</span>,</span>
<span>  <span class='st'>"GID8KO"</span> <span class='op'>=</span> <span class='st'>"#984ea3"</span>,</span>
<span>  <span class='st'>"GID9KO"</span> <span class='op'>=</span> <span class='st'>"#ff7f00"</span>,</span>
<span>  <span class='st'>"WT"</span> <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span></span>
<span><span class='va'>timepoint_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.colors</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nlevels.html'>nlevels</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>timepoint</span><span class='op'>)</span>, <span class='st'>"Set2"</span><span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>timepoint</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>group_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span></span>
<span>      <span class='va'>cell_line_colours</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span><span class='op'>]</span>,</span>
<span>      <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='fu'>colorspace</span><span class='fu'>::</span><span class='va'><a href='https://colorspace.R-Forge.R-project.org/reference/lighten.html'>lighten</a></span>, amount <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0.75</span>, <span class='fl'>0.25</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='op'>}</span></span>
<span>    <span class='op'>)</span></span>
<span>  <span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Some useful shapes</span></span>
<span><span class='va'>cell_line_shapes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>21</span><span class='op'>:</span><span class='fl'>25</span>, <span class='fl'>1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Setup DGEList object, filter, and normalize ----------------------------------</span></span>
<span></span>
<span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/SE2DGEList.html'>SE2DGEList</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Subset to relevant samples</span></span>
<span><span class='co'># NOTE: Not using criteria from preprocessing.Rmd because it is stricter than</span></span>
<span><span class='co'>#       I want/need for DE analysis. Here, I really just want to remove those</span></span>
<span><span class='co'>#       libraries with crap library size.</span></span>
<span><span class='va'>libsize_drop</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/scuttle/man/isOutlier.html'>isOutlier</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>counts</span><span class='op'>)</span>, type <span class='op'>=</span> <span class='st'>"lower"</span>, log <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='va'>keep_rep</span> <span class='op'>&lt;-</span> <span class='op'>!</span><span class='va'>libsize_drop</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>keep_rep</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>   Mode   FALSE    TRUE 
logical      17     223 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span>, <span class='va'>keep_rep</span><span class='op'>]</span></span>
<span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Sum technical replicates</span></span>
<span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/sumTechReps.html'>sumTechReps</a></span><span class='op'>(</span><span class='va'>y</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>sample</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Filter out lowly-expressed genes</span></span>
<span><span class='va'>keep</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/filterByExpr.html'>filterByExpr</a></span><span class='op'>(</span><span class='va'>y</span>, group <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>keep</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>   Mode   FALSE    TRUE 
logical     374    5313 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>[</span><span class='va'>keep</span>, , keep.lib.sizes <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span></span>
<span><span class='co'># NOTE: No need for TMMwsp because 96% of the counts in the unfiltered count</span></span>
<span><span class='co'>#       matrix are non-zero.</span></span>
<span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/calcNormFactors.html'>normLibSizes</a></span><span class='op'>(</span><span class='va'>y</span>, method <span class='op'>=</span> <span class='st'>"TMM"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span>,</span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='va'>norm.factors</span>,</span>
<span>    y <span class='op'>=</span> <span class='va'>lib.size</span>,</span>
<span>    colour <span class='op'>=</span> <span class='va'>group</span>,</span>
<span>    label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/pkg/scuttle/man/isOutlier.html'>isOutlier</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>lib.size</span>, log <span class='op'>=</span> <span class='cn'>TRUE</span>, type <span class='op'>=</span> <span class='st'>"lower"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>      <span class='st'>""</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_log10</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='va'><a href='https://scales.r-lib.org/reference/comma.html'>comma</a></span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_log10</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggrepel/man/geom_text_repel.html'>geom_label_repel</a></span><span class='op'>(</span>label.size <span class='op'>=</span> <span class='fl'>0.1</span>, max.overlaps <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<img src="DE_analysis_files/figure-html5/unnamed-chunk-1-1.png" width="624" />
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># MDS plots --------------------------------------------------------------------</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"MDS"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Original data</span></span>
<span><span class='co'># Static plots</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>null device 
          1 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"MDS"</span>, <span class='st'>"MDS.pdf"</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>8</span>, height <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/plotMDS.html'>plotMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span>,</span>
<span>  col <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Overall\nColoured by timepoint"</span><span class='op'>)</span></span>
<span><span class='va'>mds_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>  <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>mds_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>timepoint</span>, fill <span class='op'>=</span> <span class='va'>timepoint</span>, shape <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 1 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 2 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Overall"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_shapes</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span></span>
<span>    override.aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='va'>cell_line_shapes</span>, fill <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/plotMDS.html'>plotMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_3"</span><span class='op'>]</span>,</span>
<span>  col <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_3"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Day 3\nColoured by cell line"</span><span class='op'>)</span></span>
<span><span class='va'>mds_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>  <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_3"</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>mds_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>cell_line</span>, fill <span class='op'>=</span> <span class='va'>cell_line</span>, shape <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 1 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 2 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Day 3"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_shapes</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/plotMDS.html'>plotMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_6"</span><span class='op'>]</span>,</span>
<span>  col <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_6"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Day 6\nColoured by cell line"</span><span class='op'>)</span></span>
<span><span class='va'>mds_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>  <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_6"</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>mds_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>cell_line</span>, fill <span class='op'>=</span> <span class='va'>cell_line</span>, shape <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 1 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 2 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Day 6"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_shapes</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/plotMDS.html'>plotMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_9"</span><span class='op'>]</span>,</span>
<span>  col <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_9"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Day 9\nColoured by cell line"</span><span class='op'>)</span></span>
<span><span class='va'>mds_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>  <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_9"</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>mds_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>cell_line</span>, fill <span class='op'>=</span> <span class='va'>cell_line</span>, shape <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 1 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 2 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Day 9"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_shapes</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/plotMDS.html'>plotMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_12"</span><span class='op'>]</span>,</span>
<span>  col <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_12"</span><span class='op'>]</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Day 12\nColoured by cell line"</span><span class='op'>)</span></span>
<span><span class='va'>mds_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>  <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_12"</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>mds_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>cell_line</span>, fill <span class='op'>=</span> <span class='va'>cell_line</span>, shape <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 1 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 2 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Day 12"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_shapes</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>pdf 
  2 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Interactive</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/Glimma/man/glimmaMDS.html'>glimmaMDS</a></span><span class='op'>(</span><span class='va'>y</span>, html <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span>, <span class='st'>"overall.MDS.html"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/Glimma/man/glimmaMDS.html'>glimmaMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_3"</span><span class='op'>]</span>,</span>
<span>  html <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span>, <span class='st'>"Day_3.MDS.html"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/Glimma/man/glimmaMDS.html'>glimmaMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_6"</span><span class='op'>]</span>,</span>
<span>  html <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span>, <span class='st'>"Day_6.MDS.html"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/Glimma/man/glimmaMDS.html'>glimmaMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_9"</span><span class='op'>]</span>,</span>
<span>  html <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span>, <span class='st'>"Day_9.MDS.html"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/Glimma/man/glimmaMDS.html'>glimmaMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span><span class='op'>[</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span> <span class='op'>==</span> <span class='st'>"Day_12"</span><span class='op'>]</span>,</span>
<span>  html <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span>, <span class='st'>"Day_12.MDS.html"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># NOTE: Don't actually require Glimma's '_files' directory, which contains</span></span>
<span><span class='co'>#       .js and .css files, because Glimma actually generates standalone HTML</span></span>
<span><span class='co'>#       files. Unfortunately, we have to do this clean up</span></span>
<span><span class='co'>#       manually (at least for now; see</span></span>
<span><span class='co'>#       https://github.com/hasaru-k/GlimmaV2/issues/84).</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.dirs</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Adjusting for timepoint</span></span>
<span><span class='co'># NOTE: Some evidence in this plot for the claim that "GIKO cell lines seem to</span></span>
<span><span class='co'>#       arrest (compared to WT) somewhere between day 6 and 9" in that all</span></span>
<span><span class='co'>#       the samples cluster together except for the WT.Day_9 and WT.Day_12</span></span>
<span><span class='co'>#       samples.</span></span>
<span><span class='va'>y_adj</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/removeBatchEffect.html'>removeBatchEffect</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/voom.html'>voom</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>  batch <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span>,</span>
<span>  group <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>)</span></span>
<span><span class='co'># Static plots</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"MDS"</span>, <span class='st'>"MDS.adjusted_for_timepoint.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>8</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>7</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/plotMDS.html'>plotMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y_adj</span>,</span>
<span>  col <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Overall adjusted for timepoint\nColoured by timepoint"</span><span class='op'>)</span></span>
<span><span class='va'>mds_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>y</span><span class='op'>)</span>,</span>
<span>  <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span></span>
<span><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>mds_df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>x</span>, y <span class='op'>=</span> <span class='va'>y</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>timepoint</span>, fill <span class='op'>=</span> <span class='va'>timepoint</span>, shape <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>,</span>
<span>    size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 1 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"Leading logFC dim 2 ("</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fl'>100</span> <span class='op'>*</span> <span class='va'>mds</span><span class='op'>$</span><span class='va'>var.explained</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      <span class='st'>"%)"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Overall adjusted for timepoint"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_shape_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_shapes</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guide_legend.html'>guide_legend</a></span><span class='op'>(</span></span>
<span>    override.aes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='va'>cell_line_shapes</span>, fill <span class='op'>=</span> <span class='st'>"darkgrey"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span></span>
<span><span class='va'>mds</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/plotMDS.html'>plotMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y_adj</span>,</span>
<span>  col <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Overall adjusted for timepoint\nColoured by cell_line"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>pdf 
  2 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Interactive plots</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/Glimma/man/glimmaMDS.html'>glimmaMDS</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y_adj</span>,</span>
<span>  groups <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span>,</span>
<span>  labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>,</span>
<span>  html <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span>, <span class='st'>"overall_adjusted_for_Day.MDS.html"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># NOTE: Don't actually require Glimma's '_files' directory, which contains</span></span>
<span><span class='co'>#       .js and .css files, because Glimma actually generates standalone HTML</span></span>
<span><span class='co'>#       files. Unfortunately, we have to do this clean up</span></span>
<span><span class='co'>#       manually (at least for now; see</span></span>
<span><span class='co'>#       https://github.com/hasaru-k/GlimmaV2/issues/84).</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.dirs</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Multi-level DE analysis ------------------------------------------------------</span></span>
<span></span>
<span><span class='co'># NOTE: Using voomLmFit with quality weights after filtering out low-quality</span></span>
<span><span class='co'>#       replicates</span></span>
<span></span>
<span><span class='va'>design</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='fl'>0</span> <span class='op'>+</span> <span class='va'>group</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>design</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"group"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>design</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span>,</span>
<span>  <span class='va'>design</span>,</span>
<span>  block <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line_rep</span>,</span>
<span>  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  plot <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  keep.EList <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='co'># NOTE: Very low correlation (0.02)</span></span>
<span><span class='va'>fit</span><span class='op'>$</span><span class='va'>correlation</span></span></code></pre>
</div>
</details>
<pre><code>[1] 0.01920823</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>cm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/makeContrasts.html'>makeContrasts</a></span><span class='op'>(</span></span>
<span>  <span class='co'># Day6 vs. Day3 (within cell line)</span></span>
<span>  GID1KO.Day_6_vs_GID1KO.Day_3 <span class='op'>=</span> <span class='va'>GID1KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_3</span>,</span>
<span>  GID2KO.Day_6_vs_GID2KO.Day_3 <span class='op'>=</span> <span class='va'>GID2KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_3</span>,</span>
<span>  GID7KO.Day_6_vs_GID7KO.Day_3 <span class='op'>=</span> <span class='va'>GID7KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_3</span>,</span>
<span>  GID8KO.Day_6_vs_GID8KO.Day_3 <span class='op'>=</span> <span class='va'>GID8KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_3</span>,</span>
<span>  GID9KO.Day_6_vs_GID9KO.Day_3 <span class='op'>=</span> <span class='va'>GID9KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_3</span>,</span>
<span>  WT.Day_6_vs_WT.Day_3 <span class='op'>=</span> <span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span></span>
<span>  <span class='co'># Day9 vs. Day6 (within cell line)</span></span>
<span>  GID1KO.Day_9_vs_GID1KO.Day_6 <span class='op'>=</span> <span class='va'>GID1KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_6</span>,</span>
<span>  GID2KO.Day_9_vs_GID2KO.Day_6 <span class='op'>=</span> <span class='va'>GID2KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_6</span>,</span>
<span>  GID7KO.Day_9_vs_GID7KO.Day_6 <span class='op'>=</span> <span class='va'>GID7KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_6</span>,</span>
<span>  GID8KO.Day_9_vs_GID8KO.Day_6 <span class='op'>=</span> <span class='va'>GID8KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_6</span>,</span>
<span>  GID9KO.Day_9_vs_GID9KO.Day_6 <span class='op'>=</span> <span class='va'>GID9KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_6</span>,</span>
<span>  WT.Day_9_vs_WT.Day_6 <span class='op'>=</span> <span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span></span>
<span>  <span class='co'># Day12 vs. Day9 (within cell line)</span></span>
<span>  GID1KO.Day_12_vs_GID1KO.Day_9 <span class='op'>=</span> <span class='va'>GID1KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_9</span>,</span>
<span>  GID2KO.Day_12_vs_GID2KO.Day_9 <span class='op'>=</span> <span class='va'>GID2KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_9</span>,</span>
<span>  GID7KO.Day_12_vs_GID7KO.Day_9 <span class='op'>=</span> <span class='va'>GID7KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_9</span>,</span>
<span>  GID8KO.Day_12_vs_GID8KO.Day_9 <span class='op'>=</span> <span class='va'>GID8KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_9</span>,</span>
<span>  GID9KO.Day_12_vs_GID9KO.Day_9 <span class='op'>=</span> <span class='va'>GID9KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_9</span>,</span>
<span>  WT.Day_12_vs_WT.Day_9 <span class='op'>=</span> <span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span></span>
<span>  <span class='co'># Comparisons at Day 3 (cell lines vs. WT)</span></span>
<span>  GID1KO.Day_3_vs_WT.Day_3 <span class='op'>=</span> <span class='va'>GID1KO.Day_3</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span>  GID2KO.Day_3_vs_WT.Day_3 <span class='op'>=</span> <span class='va'>GID2KO.Day_3</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span>  GID7KO.Day_3_vs_WT.Day_3 <span class='op'>=</span> <span class='va'>GID7KO.Day_3</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span>  GID8KO.Day_3_vs_WT.Day_3 <span class='op'>=</span> <span class='va'>GID8KO.Day_3</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span>  GID9KO.Day_3_vs_WT.Day_3 <span class='op'>=</span> <span class='va'>GID9KO.Day_3</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span>  KOs.Day_3_vs_WT.Day_3 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_3</span> <span class='op'>+</span></span>
<span>       <span class='va'>GID9KO.Day_3</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span>  KOs_except_GID1.Day_3_vs_WT.Day_3 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID2KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID9KO.Day_3</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span>  KOs_except_GID9.Day_3_vs_WT.Day_3 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_3</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_3</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span>,</span>
<span></span>
<span>  <span class='co'># Comparisons at Day 6 (cell lines vs. WT)</span></span>
<span>  GID1KO.Day_6_vs_WT.Day_6 <span class='op'>=</span> <span class='va'>GID1KO.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span>  GID2KO.Day_6_vs_WT.Day_6 <span class='op'>=</span> <span class='va'>GID2KO.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span>  GID7KO.Day_6_vs_WT.Day_6 <span class='op'>=</span> <span class='va'>GID7KO.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span>  GID8KO.Day_6_vs_WT.Day_6 <span class='op'>=</span> <span class='va'>GID8KO.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span>  GID9KO.Day_6_vs_WT.Day_6 <span class='op'>=</span> <span class='va'>GID9KO.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span>  KOs.Day_6_vs_WT.Day_6 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_6</span> <span class='op'>+</span></span>
<span>       <span class='va'>GID9KO.Day_6</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span>  KOs_except_GID1.Day_6_vs_WT.Day_6 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID2KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID9KO.Day_6</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span>  KOs_except_GID9.Day_6_vs_WT.Day_6 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_6</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_6</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span>,</span>
<span></span>
<span>  <span class='co'># Comparisons at Day 9 (cell lines vs. WT)</span></span>
<span>  GID1KO.Day_9_vs_WT.Day_9 <span class='op'>=</span> <span class='va'>GID1KO.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span>  GID2KO.Day_9_vs_WT.Day_9 <span class='op'>=</span> <span class='va'>GID2KO.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span>  GID7KO.Day_9_vs_WT.Day_9 <span class='op'>=</span> <span class='va'>GID7KO.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span>  GID8KO.Day_9_vs_WT.Day_9 <span class='op'>=</span> <span class='va'>GID8KO.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span>  GID9KO.Day_9_vs_WT.Day_9 <span class='op'>=</span> <span class='va'>GID9KO.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span>  KOs.Day_9_vs_WT.Day_9 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_9</span> <span class='op'>+</span></span>
<span>       <span class='va'>GID9KO.Day_9</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span>  KOs_except_GID1.Day_9_vs_WT.Day_9 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID2KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID9KO.Day_9</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span>  KOs_except_GID9.Day_9_vs_WT.Day_9 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_9</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_9</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span>,</span>
<span></span>
<span>  <span class='co'># Comparisons at Day 12 (cell lines vs. WT)</span></span>
<span>  GID1KO.Day_12_vs_WT.Day_12 <span class='op'>=</span> <span class='va'>GID1KO.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_12</span>,</span>
<span>  GID2KO.Day_12_vs_WT.Day_12 <span class='op'>=</span> <span class='va'>GID2KO.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_12</span>,</span>
<span>  GID7KO.Day_12_vs_WT.Day_12 <span class='op'>=</span> <span class='va'>GID7KO.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_12</span>,</span>
<span>  GID8KO.Day_12_vs_WT.Day_12 <span class='op'>=</span> <span class='va'>GID8KO.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_12</span>,</span>
<span>  GID9KO.Day_12_vs_WT.Day_12 <span class='op'>=</span> <span class='va'>GID9KO.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_12</span>,</span>
<span>  KOs.Day_12_vs_WT.Day_12 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_12</span> <span class='op'>+</span></span>
<span>       <span class='va'>GID9KO.Day_12</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>5</span> <span class='op'>-</span> <span class='va'>WT.Day_12</span>,</span>
<span>  KOs_except_GID1.Day_12_vs_WT.Day_12 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID2KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID9KO.Day_12</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='va'>WT.Day_12</span>,</span>
<span>  KOs_except_GID9.Day_12_vs_WT.Day_12 <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID2KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID7KO.Day_12</span> <span class='op'>+</span> <span class='va'>GID8KO.Day_12</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='va'>WT.Day_12</span>,</span>
<span></span>
<span>  <span class='co'># Interactions (Day6 vs. Day3; cell lines vs. WT)</span></span>
<span>  `(GID1KO.Day_6_vs_GID1KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_3</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span>  `(GID2KO.Day_6_vs_GID2KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID2KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_3</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span>  `(GID7KO.Day_6_vs_GID7KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID7KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_3</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span>  `(GID8KO.Day_6_vs_GID8KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID8KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_3</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span>  `(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID9KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_3</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span>  `(KOs.Day_6_vs_KOs.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID1KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID2KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID7KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID8KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID9KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>5</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span>  `(KOs_except_GID1.Day_6_vs_KOs_except_GID1.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID2KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID7KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID8KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID9KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span>  `(KOs_except_GID9.Day_6_vs_KOs_except_GID9.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID1KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID2KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID7KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_3</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID8KO.Day_6</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_6</span> <span class='op'>-</span> <span class='va'>WT.Day_3</span><span class='op'>)</span>,</span>
<span></span>
<span>  <span class='co'># Interactions (Day9 vs. Day6; cell lines vs. WT)</span></span>
<span>  `(GID1KO.Day_9_vs_GID1KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_6</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span>  `(GID2KO.Day_9_vs_GID2KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID2KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_6</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span>  `(GID7KO.Day_9_vs_GID7KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID7KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_6</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span>  `(GID8KO.Day_9_vs_GID8KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID8KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_6</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span>  `(GID9KO.Day_9_vs_GID9KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID9KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_6</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span>  `(KOs.Day_9_vs_KOs.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID1KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID2KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID7KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID8KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID9KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>5</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span>  `(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID2KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID7KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID8KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID9KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span>  `(KOs_except_GID9.Day_9_vs_KOs_except_GID9.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID1KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID2KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID7KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID8KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_6</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID9KO.Day_9</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_9</span> <span class='op'>-</span> <span class='va'>WT.Day_6</span><span class='op'>)</span>,</span>
<span></span>
<span>  <span class='co'># Interactions (Day12 vs. Day9; cell lines vs. WT)</span></span>
<span>  `(GID1KO.Day_12_vs_GID1KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID1KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_9</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span>  `(GID2KO.Day_12_vs_GID2KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID2KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_9</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span>  `(GID7KO.Day_12_vs_GID7KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID7KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_9</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span>  `(GID8KO.Day_12_vs_GID8KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID8KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_9</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span>  `(GID9KO.Day_12_vs_GID9KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='va'>GID9KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_9</span><span class='op'>)</span> <span class='op'>-</span> <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span>  `(KOs.Day_12_vs_KOs.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID1KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID2KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID7KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID8KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID9KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_9</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>5</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span>  `(KOs_except_GID1.Day_12_vs_KOs_except_GID1.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID2KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID7KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID8KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID9KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_9</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span>  `(KOs_except_GID9.Day_12_vs_KOs_except_GID9.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)` <span class='op'>=</span></span>
<span>    <span class='op'>(</span><span class='op'>(</span><span class='va'>GID1KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID1KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID2KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID2KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID7KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID7KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>GID8KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID8KO.Day_9</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>       <span class='op'>(</span><span class='va'>GID9KO.Day_12</span> <span class='op'>-</span> <span class='va'>GID9KO.Day_9</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>4</span> <span class='op'>-</span></span>
<span>    <span class='op'>(</span><span class='va'>WT.Day_12</span> <span class='op'>-</span> <span class='va'>WT.Day_9</span><span class='op'>)</span>,</span>
<span></span>
<span>  levels <span class='op'>=</span> <span class='va'>design</span><span class='op'>)</span></span>
<span><span class='va'>cfit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/contrasts.fit.html'>contrasts.fit</a></span><span class='op'>(</span><span class='va'>fit</span>, <span class='va'>cm</span><span class='op'>)</span></span>
<span><span class='va'>cfit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>eBayes</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Outputs of Multi-level DE analysis -------------------------------------------</span></span>
<span></span>
<span><span class='co'># DEG lists as CSVs</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"DEGs"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>l_deg_summary_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='va'>tt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span><span class='va'>cfit</span>, <span class='va'>j</span>, number <span class='op'>=</span> <span class='cn'>Inf</span>, sort.by <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"KOs"</span>, <span class='va'>j</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='co'># Add pairwise logFCs to the 'average contrast' to enable post-hoc</span></span>
<span>    <span class='co'># filtering of genes based on 'consistent' logFCs in the pairwise</span></span>
<span>    <span class='co'># comparisons.</span></span>
<span>    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"except_GID1"</span>, <span class='va'>j</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>pairwise_coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"WT"</span>, <span class='st'>"GID1KO"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>        <span class='kw'>function</span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span>  <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"KOs\\_except\\_GID1"</span>, <span class='va'>cl</span>, <span class='va'>j</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='va'>n_pairwise</span> <span class='op'>&lt;-</span> <span class='fl'>4</span></span>
<span>    <span class='op'>}</span> <span class='kw'>else</span> <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span><span class='op'>(</span><span class='st'>"except_GID9"</span>, <span class='va'>j</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='va'>pairwise_coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"WT"</span>, <span class='st'>"GID9KO"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>        <span class='kw'>function</span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span>  <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"KOs\\_except\\_GID9"</span>, <span class='va'>cl</span>, <span class='va'>j</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='va'>n_pairwise</span> <span class='op'>&lt;-</span> <span class='fl'>4</span></span>
<span>    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>      <span class='va'>pairwise_coefs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>sapply</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>)</span>, <span class='st'>"WT"</span><span class='op'>)</span>,</span>
<span>        <span class='kw'>function</span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span>  <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"KOs"</span>, <span class='va'>cl</span>, <span class='va'>j</span><span class='op'>)</span><span class='op'>)</span></span>
<span>      <span class='va'>n_pairwise</span> <span class='op'>&lt;-</span> <span class='fl'>5</span></span>
<span>    <span class='op'>}</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>pairwise_coefs</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>pairwise_coefs</span>, <span class='st'>".logFC"</span><span class='op'>)</span></span>
<span>    <span class='va'>pairwise_lfcCons</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>pairwise_coefs</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>coef</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span><span class='va'>cfit</span>, coef <span class='op'>=</span> <span class='va'>coef</span>, sort.by <span class='op'>=</span> <span class='st'>"none"</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>$</span><span class='va'>logFC</span></span>
<span>    <span class='op'>}</span><span class='op'>)</span></span>
<span>    <span class='va'>tt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>tt</span>, <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>cbind</span>, <span class='va'>pairwise_lfcCons</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='co'># Summarise the number of DEGs in each comparison.</span></span>
<span>    <span class='co'># NOTE: Mimics summary(decideTests(cfit)) value and then repeats with added</span></span>
<span>    <span class='co'>#       'consistency of pairwise logFCs' constraint (i.e. 'lfcCon'.)</span></span>
<span>    <span class='va'>deg_summary_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>      Down <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span> <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span></span>
<span>          <span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span></span>
<span>            <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span></span>
<span>            <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>cbind</span>, <span class='va'>pairwise_lfcCons</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>==</span> <span class='va'>n_pairwise</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      NotSig <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span></span>
<span>          <span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;</span> <span class='fl'>0.05</span> <span class='op'>|</span></span>
<span>            <span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span></span>
<span>               <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span></span>
<span>               <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>cbind</span>, <span class='va'>pairwise_lfcCons</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>n_pairwise</span><span class='op'>)</span> <span class='op'>|</span></span>
<span>            <span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span></span>
<span>            <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span></span>
<span>            <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>cbind</span>, <span class='va'>pairwise_lfcCons</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>&lt;</span> <span class='va'>n_pairwise</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      Up <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span> <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span></span>
<span>          <span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span></span>
<span>            <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span></span>
<span>            <span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>cbind</span>, <span class='va'>pairwise_lfcCons</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'>==</span> <span class='va'>n_pairwise</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".lfcCon"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='co'># Summarise the number of DEGs in each comparison</span></span>
<span>    <span class='co'># NOTE: Mimics summary(decideTests(cfit)) value.</span></span>
<span>    <span class='va'>deg_summary_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>      Down <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span> <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      NotSig <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span> <span class='op'>)</span>,</span>
<span>      Up <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span> <span class='op'>&amp;</span> <span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span>,</span>
<span>      row.names <span class='op'>=</span> <span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span></span>
<span>  <span class='co'># Write topTable results to CSV</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>    <span class='fu'>flattenDF</span><span class='op'>(</span><span class='va'>tt</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"DEGs"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".DEGs.csv"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>deg_summary_df</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span><span class='co'># Summarise the number of DEGs in each comparison</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span><span class='va'>rbind</span>, <span class='va'>l_deg_summary_df</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                                                                                    Down
GID1KO.Day_6_vs_GID1KO.Day_3                                                        1628
GID2KO.Day_6_vs_GID2KO.Day_3                                                        1697
GID7KO.Day_6_vs_GID7KO.Day_3                                                        1583
GID8KO.Day_6_vs_GID8KO.Day_3                                                        1483
GID9KO.Day_6_vs_GID9KO.Day_3                                                        1385
WT.Day_6_vs_WT.Day_3                                                                1533
GID1KO.Day_9_vs_GID1KO.Day_6                                                        1010
GID2KO.Day_9_vs_GID2KO.Day_6                                                         722
GID7KO.Day_9_vs_GID7KO.Day_6                                                         750
GID8KO.Day_9_vs_GID8KO.Day_6                                                         526
GID9KO.Day_9_vs_GID9KO.Day_6                                                         557
WT.Day_9_vs_WT.Day_6                                                                1379
GID1KO.Day_12_vs_GID1KO.Day_9                                                        799
GID2KO.Day_12_vs_GID2KO.Day_9                                                        463
GID7KO.Day_12_vs_GID7KO.Day_9                                                        428
GID8KO.Day_12_vs_GID8KO.Day_9                                                        378
GID9KO.Day_12_vs_GID9KO.Day_9                                                        397
WT.Day_12_vs_WT.Day_9                                                                828
GID1KO.Day_3_vs_WT.Day_3                                                              19
GID2KO.Day_3_vs_WT.Day_3                                                             154
GID7KO.Day_3_vs_WT.Day_3                                                               2
GID8KO.Day_3_vs_WT.Day_3                                                               7
GID9KO.Day_3_vs_WT.Day_3                                                             231
KOs.Day_3_vs_WT.Day_3                                                                 12
KOs.Day_3_vs_WT.Day_3.lfcCon                                                           9
KOs_except_GID1.Day_3_vs_WT.Day_3                                                     12
KOs_except_GID1.Day_3_vs_WT.Day_3.lfcCon                                               8
KOs_except_GID9.Day_3_vs_WT.Day_3                                                      4
KOs_except_GID9.Day_3_vs_WT.Day_3.lfcCon                                               3
GID1KO.Day_6_vs_WT.Day_6                                                              43
GID2KO.Day_6_vs_WT.Day_6                                                             273
GID7KO.Day_6_vs_WT.Day_6                                                             162
GID8KO.Day_6_vs_WT.Day_6                                                             193
GID9KO.Day_6_vs_WT.Day_6                                                              91
KOs.Day_6_vs_WT.Day_6                                                                263
KOs.Day_6_vs_WT.Day_6.lfcCon                                                         260
KOs_except_GID1.Day_6_vs_WT.Day_6                                                    324
KOs_except_GID1.Day_6_vs_WT.Day_6.lfcCon                                             324
KOs_except_GID9.Day_6_vs_WT.Day_6                                                    247
KOs_except_GID9.Day_6_vs_WT.Day_6.lfcCon                                             245
GID1KO.Day_9_vs_WT.Day_9                                                            1280
GID2KO.Day_9_vs_WT.Day_9                                                            1229
GID7KO.Day_9_vs_WT.Day_9                                                            1265
GID8KO.Day_9_vs_WT.Day_9                                                            1068
GID9KO.Day_9_vs_WT.Day_9                                                            1292
KOs.Day_9_vs_WT.Day_9                                                               1489
KOs.Day_9_vs_WT.Day_9.lfcCon                                                        1433
KOs_except_GID1.Day_9_vs_WT.Day_9                                                   1476
KOs_except_GID1.Day_9_vs_WT.Day_9.lfcCon                                            1462
KOs_except_GID9.Day_9_vs_WT.Day_9                                                   1446
KOs_except_GID9.Day_9_vs_WT.Day_9.lfcCon                                            1406
GID1KO.Day_12_vs_WT.Day_12                                                          1257
GID2KO.Day_12_vs_WT.Day_12                                                          1510
GID7KO.Day_12_vs_WT.Day_12                                                          1475
GID8KO.Day_12_vs_WT.Day_12                                                          1572
GID9KO.Day_12_vs_WT.Day_12                                                          1500
KOs.Day_12_vs_WT.Day_12                                                             1642
KOs.Day_12_vs_WT.Day_12.lfcCon                                                      1566
KOs_except_GID1.Day_12_vs_WT.Day_12                                                 1656
KOs_except_GID1.Day_12_vs_WT.Day_12.lfcCon                                          1649
KOs_except_GID9.Day_12_vs_WT.Day_12                                                 1614
KOs_except_GID9.Day_12_vs_WT.Day_12.lfcCon                                          1545
(GID1KO.Day_6_vs_GID1KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              47
(GID2KO.Day_6_vs_GID2KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              15
(GID7KO.Day_6_vs_GID7KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              29
(GID8KO.Day_6_vs_GID8KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              16
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                             338
(KOs.Day_6_vs_KOs.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                                    81
(KOs.Day_6_vs_KOs.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon                             65
(KOs_except_GID1.Day_6_vs_KOs_except_GID1.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)            85
(KOs_except_GID1.Day_6_vs_KOs_except_GID1.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon     70
(KOs_except_GID9.Day_6_vs_KOs_except_GID9.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)            24
(KOs_except_GID9.Day_6_vs_KOs_except_GID9.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon     24
(GID1KO.Day_9_vs_GID1KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             714
(GID2KO.Day_9_vs_GID2KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             793
(GID7KO.Day_9_vs_GID7KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             777
(GID8KO.Day_9_vs_GID8KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             729
(GID9KO.Day_9_vs_GID9KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             772
(KOs.Day_9_vs_KOs.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                                   986
(KOs.Day_9_vs_KOs.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon                            980
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)          1005
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon   1003
(KOs_except_GID9.Day_9_vs_KOs_except_GID9.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)           913
(KOs_except_GID9.Day_9_vs_KOs_except_GID9.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon    901
(GID1KO.Day_12_vs_GID1KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           575
(GID2KO.Day_12_vs_GID2KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           703
(GID7KO.Day_12_vs_GID7KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           572
(GID8KO.Day_12_vs_GID8KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           618
(GID9KO.Day_12_vs_GID9KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           659
(KOs.Day_12_vs_KOs.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                                 885
(KOs.Day_12_vs_KOs.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon                          841
(KOs_except_GID1.Day_12_vs_KOs_except_GID1.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)         911
(KOs_except_GID1.Day_12_vs_KOs_except_GID1.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon  902
(KOs_except_GID9.Day_12_vs_KOs_except_GID9.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)         827
(KOs_except_GID9.Day_12_vs_KOs_except_GID9.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon  798
                                                                                    NotSig
GID1KO.Day_6_vs_GID1KO.Day_3                                                          2037
GID2KO.Day_6_vs_GID2KO.Day_3                                                          1978
GID7KO.Day_6_vs_GID7KO.Day_3                                                          2149
GID8KO.Day_6_vs_GID8KO.Day_3                                                          2394
GID9KO.Day_6_vs_GID9KO.Day_3                                                          2400
WT.Day_6_vs_WT.Day_3                                                                  2341
GID1KO.Day_9_vs_GID1KO.Day_6                                                          3327
GID2KO.Day_9_vs_GID2KO.Day_6                                                          3793
GID7KO.Day_9_vs_GID7KO.Day_6                                                          3830
GID8KO.Day_9_vs_GID8KO.Day_6                                                          4108
GID9KO.Day_9_vs_GID9KO.Day_6                                                          4140
WT.Day_9_vs_WT.Day_6                                                                  2584
GID1KO.Day_12_vs_GID1KO.Day_9                                                         3427
GID2KO.Day_12_vs_GID2KO.Day_9                                                         4215
GID7KO.Day_12_vs_GID7KO.Day_9                                                         4177
GID8KO.Day_12_vs_GID8KO.Day_9                                                         4527
GID9KO.Day_12_vs_GID9KO.Day_9                                                         4317
WT.Day_12_vs_WT.Day_9                                                                 3306
GID1KO.Day_3_vs_WT.Day_3                                                              5265
GID2KO.Day_3_vs_WT.Day_3                                                              5012
GID7KO.Day_3_vs_WT.Day_3                                                              5302
GID8KO.Day_3_vs_WT.Day_3                                                              5302
GID9KO.Day_3_vs_WT.Day_3                                                              4647
KOs.Day_3_vs_WT.Day_3                                                                 5256
KOs.Day_3_vs_WT.Day_3.lfcCon                                                          5290
KOs_except_GID1.Day_3_vs_WT.Day_3                                                     5247
KOs_except_GID1.Day_3_vs_WT.Day_3.lfcCon                                              5292
KOs_except_GID9.Day_3_vs_WT.Day_3                                                     5307
KOs_except_GID9.Day_3_vs_WT.Day_3.lfcCon                                              5308
GID1KO.Day_6_vs_WT.Day_6                                                              5221
GID2KO.Day_6_vs_WT.Day_6                                                              4819
GID7KO.Day_6_vs_WT.Day_6                                                              4971
GID8KO.Day_6_vs_WT.Day_6                                                              4972
GID9KO.Day_6_vs_WT.Day_6                                                              5080
KOs.Day_6_vs_WT.Day_6                                                                 4839
KOs.Day_6_vs_WT.Day_6.lfcCon                                                          4846
KOs_except_GID1.Day_6_vs_WT.Day_6                                                     4721
KOs_except_GID1.Day_6_vs_WT.Day_6.lfcCon                                              4721
KOs_except_GID9.Day_6_vs_WT.Day_6                                                     4884
KOs_except_GID9.Day_6_vs_WT.Day_6.lfcCon                                              4888
GID1KO.Day_9_vs_WT.Day_9                                                              2888
GID2KO.Day_9_vs_WT.Day_9                                                              2961
GID7KO.Day_9_vs_WT.Day_9                                                              2953
GID8KO.Day_9_vs_WT.Day_9                                                              3326
GID9KO.Day_9_vs_WT.Day_9                                                              2852
KOs.Day_9_vs_WT.Day_9                                                                 2391
KOs.Day_9_vs_WT.Day_9.lfcCon                                                          2513
KOs_except_GID1.Day_9_vs_WT.Day_9                                                     2428
KOs_except_GID1.Day_9_vs_WT.Day_9.lfcCon                                              2458
KOs_except_GID9.Day_9_vs_WT.Day_9                                                     2495
KOs_except_GID9.Day_9_vs_WT.Day_9.lfcCon                                              2582
GID1KO.Day_12_vs_WT.Day_12                                                            3115
GID2KO.Day_12_vs_WT.Day_12                                                            2373
GID7KO.Day_12_vs_WT.Day_12                                                            2621
GID8KO.Day_12_vs_WT.Day_12                                                            2224
GID9KO.Day_12_vs_WT.Day_12                                                            2519
KOs.Day_12_vs_WT.Day_12                                                               2241
KOs.Day_12_vs_WT.Day_12.lfcCon                                                        2348
KOs_except_GID1.Day_12_vs_WT.Day_12                                                   2157
KOs_except_GID1.Day_12_vs_WT.Day_12.lfcCon                                            2166
KOs_except_GID9.Day_12_vs_WT.Day_12                                                   2298
KOs_except_GID9.Day_12_vs_WT.Day_12.lfcCon                                            2389
(GID1KO.Day_6_vs_GID1KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              5249
(GID2KO.Day_6_vs_GID2KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              5257
(GID7KO.Day_6_vs_GID7KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              5262
(GID8KO.Day_6_vs_GID8KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              5285
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              4805
(KOs.Day_6_vs_KOs.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                                    5189
(KOs.Day_6_vs_KOs.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon                             5205
(KOs_except_GID1.Day_6_vs_KOs_except_GID1.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)            5183
(KOs_except_GID1.Day_6_vs_KOs_except_GID1.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon     5198
(KOs_except_GID9.Day_6_vs_KOs_except_GID9.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)            5263
(KOs_except_GID9.Day_6_vs_KOs_except_GID9.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon     5263
(GID1KO.Day_9_vs_GID1KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                              4210
(GID2KO.Day_9_vs_GID2KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                              3998
(GID7KO.Day_9_vs_GID7KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                              4090
(GID8KO.Day_9_vs_GID8KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                              4146
(GID9KO.Day_9_vs_GID9KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                              4116
(KOs.Day_9_vs_KOs.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                                    3656
(KOs.Day_9_vs_KOs.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon                             3674
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)            3614
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon     3618
(KOs_except_GID9.Day_9_vs_KOs_except_GID9.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)            3832
(KOs_except_GID9.Day_9_vs_KOs_except_GID9.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon     3858
(GID1KO.Day_12_vs_GID1KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                            4242
(GID2KO.Day_12_vs_GID2KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                            4146
(GID7KO.Day_12_vs_GID7KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                            4337
(GID8KO.Day_12_vs_GID8KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                            4328
(GID9KO.Day_12_vs_GID9KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                            4196
(KOs.Day_12_vs_KOs.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                                  3821
(KOs.Day_12_vs_KOs.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon                           3875
(KOs_except_GID1.Day_12_vs_KOs_except_GID1.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)          3783
(KOs_except_GID1.Day_12_vs_KOs_except_GID1.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon   3793
(KOs_except_GID9.Day_12_vs_KOs_except_GID9.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)          3865
(KOs_except_GID9.Day_12_vs_KOs_except_GID9.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon   3921
                                                                                      Up
GID1KO.Day_6_vs_GID1KO.Day_3                                                        1648
GID2KO.Day_6_vs_GID2KO.Day_3                                                        1638
GID7KO.Day_6_vs_GID7KO.Day_3                                                        1581
GID8KO.Day_6_vs_GID8KO.Day_3                                                        1436
GID9KO.Day_6_vs_GID9KO.Day_3                                                        1528
WT.Day_6_vs_WT.Day_3                                                                1439
GID1KO.Day_9_vs_GID1KO.Day_6                                                         976
GID2KO.Day_9_vs_GID2KO.Day_6                                                         798
GID7KO.Day_9_vs_GID7KO.Day_6                                                         733
GID8KO.Day_9_vs_GID8KO.Day_6                                                         679
GID9KO.Day_9_vs_GID9KO.Day_6                                                         616
WT.Day_9_vs_WT.Day_6                                                                1350
GID1KO.Day_12_vs_GID1KO.Day_9                                                       1087
GID2KO.Day_12_vs_GID2KO.Day_9                                                        635
GID7KO.Day_12_vs_GID7KO.Day_9                                                        708
GID8KO.Day_12_vs_GID8KO.Day_9                                                        408
GID9KO.Day_12_vs_GID9KO.Day_9                                                        599
WT.Day_12_vs_WT.Day_9                                                               1179
GID1KO.Day_3_vs_WT.Day_3                                                              29
GID2KO.Day_3_vs_WT.Day_3                                                             147
GID7KO.Day_3_vs_WT.Day_3                                                               9
GID8KO.Day_3_vs_WT.Day_3                                                               4
GID9KO.Day_3_vs_WT.Day_3                                                             435
KOs.Day_3_vs_WT.Day_3                                                                 45
KOs.Day_3_vs_WT.Day_3.lfcCon                                                          14
KOs_except_GID1.Day_3_vs_WT.Day_3                                                     54
KOs_except_GID1.Day_3_vs_WT.Day_3.lfcCon                                              13
KOs_except_GID9.Day_3_vs_WT.Day_3                                                      2
KOs_except_GID9.Day_3_vs_WT.Day_3.lfcCon                                               2
GID1KO.Day_6_vs_WT.Day_6                                                              49
GID2KO.Day_6_vs_WT.Day_6                                                             221
GID7KO.Day_6_vs_WT.Day_6                                                             180
GID8KO.Day_6_vs_WT.Day_6                                                             148
GID9KO.Day_6_vs_WT.Day_6                                                             142
KOs.Day_6_vs_WT.Day_6                                                                211
KOs.Day_6_vs_WT.Day_6.lfcCon                                                         207
KOs_except_GID1.Day_6_vs_WT.Day_6                                                    268
KOs_except_GID1.Day_6_vs_WT.Day_6.lfcCon                                             268
KOs_except_GID9.Day_6_vs_WT.Day_6                                                    182
KOs_except_GID9.Day_6_vs_WT.Day_6.lfcCon                                             180
GID1KO.Day_9_vs_WT.Day_9                                                            1145
GID2KO.Day_9_vs_WT.Day_9                                                            1123
GID7KO.Day_9_vs_WT.Day_9                                                            1095
GID8KO.Day_9_vs_WT.Day_9                                                             919
GID9KO.Day_9_vs_WT.Day_9                                                            1169
KOs.Day_9_vs_WT.Day_9                                                               1433
KOs.Day_9_vs_WT.Day_9.lfcCon                                                        1367
KOs_except_GID1.Day_9_vs_WT.Day_9                                                   1409
KOs_except_GID1.Day_9_vs_WT.Day_9.lfcCon                                            1393
KOs_except_GID9.Day_9_vs_WT.Day_9                                                   1372
KOs_except_GID9.Day_9_vs_WT.Day_9.lfcCon                                            1325
GID1KO.Day_12_vs_WT.Day_12                                                           941
GID2KO.Day_12_vs_WT.Day_12                                                          1430
GID7KO.Day_12_vs_WT.Day_12                                                          1217
GID8KO.Day_12_vs_WT.Day_12                                                          1517
GID9KO.Day_12_vs_WT.Day_12                                                          1294
KOs.Day_12_vs_WT.Day_12                                                             1430
KOs.Day_12_vs_WT.Day_12.lfcCon                                                      1399
KOs_except_GID1.Day_12_vs_WT.Day_12                                                 1500
KOs_except_GID1.Day_12_vs_WT.Day_12.lfcCon                                          1498
KOs_except_GID9.Day_12_vs_WT.Day_12                                                 1401
KOs_except_GID9.Day_12_vs_WT.Day_12.lfcCon                                          1379
(GID1KO.Day_6_vs_GID1KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              17
(GID2KO.Day_6_vs_GID2KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              41
(GID7KO.Day_6_vs_GID7KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              22
(GID8KO.Day_6_vs_GID8KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                              12
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                             170
(KOs.Day_6_vs_KOs.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)                                    43
(KOs.Day_6_vs_KOs.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon                             43
(KOs_except_GID1.Day_6_vs_KOs_except_GID1.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)            45
(KOs_except_GID1.Day_6_vs_KOs_except_GID1.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon     45
(KOs_except_GID9.Day_6_vs_KOs_except_GID9.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)            26
(KOs_except_GID9.Day_6_vs_KOs_except_GID9.Day_3)_vs_(WT.Day_6_vs_WT.Day_3).lfcCon     26
(GID1KO.Day_9_vs_GID1KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             389
(GID2KO.Day_9_vs_GID2KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             522
(GID7KO.Day_9_vs_GID7KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             446
(GID8KO.Day_9_vs_GID8KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             438
(GID9KO.Day_9_vs_GID9KO.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                             425
(KOs.Day_9_vs_KOs.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)                                   671
(KOs.Day_9_vs_KOs.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon                            659
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)           694
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon    692
(KOs_except_GID9.Day_9_vs_KOs_except_GID9.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)           568
(KOs_except_GID9.Day_9_vs_KOs_except_GID9.Day_6)_vs_(WT.Day_9_vs_WT.Day_6).lfcCon    554
(GID1KO.Day_12_vs_GID1KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           496
(GID2KO.Day_12_vs_GID2KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           464
(GID7KO.Day_12_vs_GID7KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           404
(GID8KO.Day_12_vs_GID8KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           367
(GID9KO.Day_12_vs_GID9KO.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                           458
(KOs.Day_12_vs_KOs.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)                                 607
(KOs.Day_12_vs_KOs.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon                          597
(KOs_except_GID1.Day_12_vs_KOs_except_GID1.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)         619
(KOs_except_GID1.Day_12_vs_KOs_except_GID1.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon  618
(KOs_except_GID9.Day_12_vs_KOs_except_GID9.Day_9)_vs_(WT.Day_12_vs_WT.Day_9)         621
(KOs_except_GID9.Day_12_vs_KOs_except_GID9.Day_9)_vs_(WT.Day_12_vs_WT.Day_9).lfcCon  594</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Glimma MA plots</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/Glimma/man/glimmaMA.html'>glimmaMA</a></span><span class='op'>(</span></span>
<span>    x <span class='op'>=</span> <span class='va'>cfit</span>,</span>
<span>    dge <span class='op'>=</span> <span class='va'>y</span>,</span>
<span>    coef <span class='op'>=</span> <span class='va'>j</span>,</span>
<span>    anno <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GENEID"</span>, <span class='st'>"Name"</span>, <span class='st'>"description"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>    sample.cols <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='va'>group_colours</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>    html <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"output"</span>,</span>
<span>      <span class='st'>"Glimma"</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".html"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>j</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL

[[5]]
NULL

[[6]]
NULL

[[7]]
NULL

[[8]]
NULL

[[9]]
NULL

[[10]]
NULL

[[11]]
NULL

[[12]]
NULL

[[13]]
NULL

[[14]]
NULL

[[15]]
NULL

[[16]]
NULL

[[17]]
NULL

[[18]]
NULL

[[19]]
NULL

[[20]]
NULL

[[21]]
NULL

[[22]]
NULL

[[23]]
NULL

[[24]]
NULL

[[25]]
NULL

[[26]]
NULL

[[27]]
NULL

[[28]]
NULL

[[29]]
NULL

[[30]]
NULL

[[31]]
NULL

[[32]]
NULL

[[33]]
NULL

[[34]]
NULL

[[35]]
NULL

[[36]]
NULL

[[37]]
NULL

[[38]]
NULL

[[39]]
NULL

[[40]]
NULL

[[41]]
NULL

[[42]]
NULL

[[43]]
NULL

[[44]]
NULL

[[45]]
NULL

[[46]]
NULL

[[47]]
NULL

[[48]]
NULL

[[49]]
NULL

[[50]]
NULL

[[51]]
NULL

[[52]]
NULL

[[53]]
NULL

[[54]]
NULL

[[55]]
NULL

[[56]]
NULL

[[57]]
NULL

[[58]]
NULL

[[59]]
NULL

[[60]]
NULL

[[61]]
NULL

[[62]]
NULL

[[63]]
NULL

[[64]]
NULL

[[65]]
NULL

[[66]]
NULL

[[67]]
NULL

[[68]]
NULL

[[69]]
NULL

[[70]]
NULL

[[71]]
NULL

[[72]]
NULL

[[73]]
NULL

[[74]]
NULL</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># NOTE: Don't actually require Glimma's '_files' directory, which contains</span></span>
<span><span class='co'>#       .js and .css files, because Glimma actually generates standalone HTML</span></span>
<span><span class='co'>#       files. Unfortunately, we have to do this clean up</span></span>
<span><span class='co'>#       manually (at least for now; see</span></span>
<span><span class='co'>#       https://github.com/hasaru-k/GlimmaV2/issues/84).</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/unlink.html'>unlink</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.dirs</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Glimma"</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>, recursive <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Heatmaps</span></span>
<span><span class='va'>lcpm</span> <span class='op'>&lt;-</span> <span class='fu'>edgeR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/cpm.html'>cpm</a></span><span class='op'>(</span><span class='va'>y</span>, log <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"heatmaps"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='co'># 1. Samples ordered by `group`.</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lcpm</span><span class='op'>[</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span><span class='va'>cfit</span>, coef <span class='op'>=</span> <span class='va'>j</span>, n <span class='op'>=</span> <span class='fl'>50</span>, p.value <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>    scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>    fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"_vs_"</span>, <span class='st'>" vs. "</span>, <span class='va'>j</span><span class='op'>)</span>,</span>
<span>    annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>    angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>    treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"heatmaps"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".ordered.pdf"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lcpm</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span><span class='va'>cfit</span>, coef <span class='op'>=</span> <span class='va'>j</span>, n <span class='op'>=</span> <span class='fl'>50</span>, p.value <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>, <span class='op'>]</span>,</span>
<span>    scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>    fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"_vs_"</span>, <span class='st'>" vs. "</span>, <span class='va'>j</span><span class='op'>)</span>,</span>
<span>    annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>      cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>      timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span>,</span>
<span>    angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>    treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>    filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"heatmaps"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".clustered.pdf"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='co'># 3. Samples subsetted to those involved in the comparison and then clustered</span></span>
<span>  <span class='co'>#    by expression pattern.</span></span>
<span>  <span class='va'>jj</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>cm</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span><span class='op'>[</span><span class='va'>cm</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span> <span class='op'>!=</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lcpm</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span><span class='va'>cfit</span>, coef <span class='op'>=</span> <span class='va'>j</span>, n <span class='op'>=</span> <span class='fl'>50</span>, p.value <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>, <span class='va'>jj</span><span class='op'>]</span>,</span>
<span>    scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>    fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    annotation_col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span><span class='va'>jj</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>    main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"_vs_"</span>, <span class='st'>" vs. "</span>, <span class='va'>j</span><span class='op'>)</span>,</span>
<span>    annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>      cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>[</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>[</span><span class='va'>jj</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>      timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>[</span></span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span><span class='op'>[</span><span class='va'>jj</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>    angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>    treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>    filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"output"</span>,</span>
<span>      <span class='st'>"heatmaps"</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".clustered.only_relevant_samples.pdf"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[[1]]

[[2]]

[[3]]

[[4]]

[[5]]

[[6]]

[[7]]

[[8]]

[[9]]

[[10]]

[[11]]

[[12]]

[[13]]

[[14]]

[[15]]

[[16]]

[[17]]

[[18]]

[[19]]

[[20]]

[[21]]

[[22]]

[[23]]

[[24]]

[[25]]

[[26]]

[[27]]

[[28]]

[[29]]

[[30]]

[[31]]

[[32]]

[[33]]

[[34]]

[[35]]

[[36]]

[[37]]

[[38]]

[[39]]

[[40]]

[[41]]

[[42]]

[[43]]

[[44]]

[[45]]

[[46]]

[[47]]

[[48]]

[[49]]

[[50]]

[[51]]

[[52]]

[[53]]

[[54]]

[[55]]

[[56]]

[[57]]

[[58]]

[[59]]

[[60]]

[[61]]

[[62]]

[[63]]

[[64]]

[[65]]

[[66]]

[[67]]

[[68]]

[[69]]

[[70]]

[[71]]

[[72]]

[[73]]

[[74]]</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Gene set analyses ------------------------------------------------------------</span></span>
<span></span>
<span><span class='co'># Load .gaf file with GO annotations.</span></span>
<span><span class='va'>gaf</span> <span class='op'>&lt;-</span> <span class='fu'>GOSemSim</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/GOSemSim/man/read-gaf.html'>read.gaf</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"annotation"</span>, <span class='st'>"PlasmoDB-66_Pfalciparum3D7_GO.gaf.gzip"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>Reading /vast/scratch/users/hickey/G000396_Danu/data/annotation/PlasmoDB-66_Pfalciparum3D7_GO.gaf.gzip: found 31678 rows in this GAF file</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>idx</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ids2indices.html'>ids2indices</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/split.html'>split</a></span><span class='op'>(</span><span class='va'>gaf</span><span class='op'>$</span><span class='va'>TERM2GENE</span><span class='op'>$</span><span class='va'>Gene</span>, <span class='va'>gaf</span><span class='op'>$</span><span class='va'>TERM2GENE</span><span class='op'>$</span><span class='va'>GO</span><span class='op'>)</span>,</span>
<span>  id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>GENEID</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>gene.pathway</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  GeneID <span class='op'>=</span> <span class='va'>gaf</span><span class='op'>$</span><span class='va'>TERM2GENE</span><span class='op'>$</span><span class='va'>Gene</span>,</span>
<span>  PathwayID <span class='op'>=</span> <span class='va'>gaf</span><span class='op'>$</span><span class='va'>TERM2GENE</span><span class='op'>$</span><span class='va'>GO</span><span class='op'>)</span></span>
<span><span class='va'>pathway.names</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  PathwayID <span class='op'>=</span> <span class='va'>gaf</span><span class='op'>$</span><span class='va'>TERM2NAME</span><span class='op'>$</span><span class='va'>GOID</span>,</span>
<span>  Description <span class='op'>=</span> <span class='va'>gaf</span><span class='op'>$</span><span class='va'>TERM2NAME</span><span class='op'>$</span><span class='va'>TERM</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># NOTE: kegga() performs over-representation analyses (i.e. hypergeometric</span></span>
<span><span class='co'>#       test) of gene lists.</span></span>
<span><span class='co'>#       I _think_ it is a competitive test.</span></span>
<span><span class='co'># NOTE: This is a way to hack kegga() to perform goana()-style analysis</span></span>
<span><span class='co'>#       for non-supported species (such as plasmodium), which Alex Garnham</span></span>
<span><span class='co'>#       showed me on 2023-12-05.</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>tt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span><span class='va'>cfit</span>, <span class='va'>j</span>, n <span class='op'>=</span> <span class='cn'>Inf</span>, p.value <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span></span>
<span>  <span class='va'>keg_up</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/goana.html'>kegga.default</a></span><span class='op'>(</span></span>
<span>    de <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>GENEID</span><span class='op'>[</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>    universe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>GENEID</span><span class='op'>)</span>,</span>
<span>    gene.pathway <span class='op'>=</span> <span class='va'>gene.pathway</span>,</span>
<span>    pathway.names <span class='op'>=</span> <span class='va'>pathway.names</span><span class='op'>)</span></span>
<span>  <span class='va'>keg_down</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/goana.html'>kegga.default</a></span><span class='op'>(</span></span>
<span>    de <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>GENEID</span><span class='op'>[</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>logFC</span> <span class='op'>&lt;</span> <span class='fl'>0</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>    universe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>GENEID</span><span class='op'>)</span>,</span>
<span>    gene.pathway <span class='op'>=</span> <span class='va'>gene.pathway</span>,</span>
<span>    pathway.names <span class='op'>=</span> <span class='va'>pathway.names</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/limma/man/topGO.html'>topKEGG</a></span><span class='op'>(</span><span class='va'>keg_up</span>, p.value <span class='op'>=</span> <span class='fl'>0.05</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"DEGs"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".upregulated.kegga_with_GO.csv"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/limma/man/topGO.html'>topKEGG</a></span><span class='op'>(</span><span class='va'>keg_down</span>, p.value <span class='op'>=</span> <span class='fl'>0.05</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"DEGs"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".downregulated.kegga_with_GO.csv"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL

[[5]]
NULL

[[6]]
NULL

[[7]]
NULL

[[8]]
NULL

[[9]]
NULL

[[10]]
NULL

[[11]]
NULL

[[12]]
NULL

[[13]]
NULL

[[14]]
NULL

[[15]]
NULL

[[16]]
NULL

[[17]]
NULL

[[18]]
NULL

[[19]]
NULL

[[20]]
NULL

[[21]]
NULL

[[22]]
NULL

[[23]]
NULL

[[24]]
NULL

[[25]]
NULL

[[26]]
NULL

[[27]]
NULL

[[28]]
NULL

[[29]]
NULL

[[30]]
NULL

[[31]]
NULL

[[32]]
NULL

[[33]]
NULL

[[34]]
NULL

[[35]]
NULL

[[36]]
NULL

[[37]]
NULL

[[38]]
NULL

[[39]]
NULL

[[40]]
NULL

[[41]]
NULL

[[42]]
NULL

[[43]]
NULL

[[44]]
NULL

[[45]]
NULL

[[46]]
NULL

[[47]]
NULL

[[48]]
NULL

[[49]]
NULL

[[50]]
NULL

[[51]]
NULL

[[52]]
NULL

[[53]]
NULL

[[54]]
NULL

[[55]]
NULL

[[56]]
NULL

[[57]]
NULL

[[58]]
NULL

[[59]]
NULL

[[60]]
NULL

[[61]]
NULL

[[62]]
NULL

[[63]]
NULL

[[64]]
NULL

[[65]]
NULL

[[66]]
NULL

[[67]]
NULL

[[68]]
NULL

[[69]]
NULL

[[70]]
NULL

[[71]]
NULL

[[72]]
NULL

[[73]]
NULL

[[74]]
NULL</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># NOTE: https://bioconductor.org/packages/release/workflows/vignettes/RNAseq123/inst/doc/limmaWorkflow.html#gene-set-testing-with-camera</span></span>
<span><span class='co'>#       suggests using camera() rather than mroast() [or fry()] when doing</span></span>
<span><span class='co'>#       'fishing' analyses.</span></span>
<span></span>
<span><span class='co'># NOTE: camera() is a competitive gene set test that accounts for inter-gene</span></span>
<span><span class='co'>#       correlation.</span></span>
<span><span class='co'># NOTE: camera() can't incorporate random effect but cameraPR() can</span></span>
<span><span class='co'>#       (https://support.bioconductor.org/p/78299/).</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='va'>campr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/camera.html'>cameraPR</a></span><span class='op'>(</span>statistic <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span>, index <span class='op'>=</span> <span class='va'>idx</span><span class='op'>)</span></span>
<span>  <span class='va'>campr</span><span class='op'>$</span><span class='va'>GO</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>campr</span><span class='op'>)</span></span>
<span>  <span class='va'>campr</span> <span class='op'>&lt;-</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate-joins.html'>left_join</a></span><span class='op'>(</span><span class='va'>campr</span>, <span class='va'>gaf</span><span class='op'>$</span><span class='va'>TERM2NAME</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GO"</span> <span class='op'>=</span> <span class='st'>"GOID"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>campr</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>campr</span><span class='op'>$</span><span class='va'>GO</span></span>
<span>  <span class='va'>campr</span> <span class='op'>&lt;-</span> <span class='va'>campr</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"TERM"</span>, <span class='st'>"NGenes"</span>, <span class='st'>"Direction"</span>, <span class='st'>"PValue"</span>, <span class='st'>"FDR"</span><span class='op'>)</span><span class='op'>]</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>    <span class='va'>campr</span>,</span>
<span>    <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"DEGs"</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>j</span>, <span class='st'>".camera.csv"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>[[1]]
NULL

[[2]]
NULL

[[3]]
NULL

[[4]]
NULL

[[5]]
NULL

[[6]]
NULL

[[7]]
NULL

[[8]]
NULL

[[9]]
NULL

[[10]]
NULL

[[11]]
NULL

[[12]]
NULL

[[13]]
NULL

[[14]]
NULL

[[15]]
NULL

[[16]]
NULL

[[17]]
NULL

[[18]]
NULL

[[19]]
NULL

[[20]]
NULL

[[21]]
NULL

[[22]]
NULL

[[23]]
NULL

[[24]]
NULL

[[25]]
NULL

[[26]]
NULL

[[27]]
NULL

[[28]]
NULL

[[29]]
NULL

[[30]]
NULL

[[31]]
NULL

[[32]]
NULL

[[33]]
NULL

[[34]]
NULL

[[35]]
NULL

[[36]]
NULL

[[37]]
NULL

[[38]]
NULL

[[39]]
NULL

[[40]]
NULL

[[41]]
NULL

[[42]]
NULL

[[43]]
NULL

[[44]]
NULL

[[45]]
NULL

[[46]]
NULL

[[47]]
NULL

[[48]]
NULL

[[49]]
NULL

[[50]]
NULL

[[51]]
NULL

[[52]]
NULL

[[53]]
NULL

[[54]]
NULL

[[55]]
NULL

[[56]]
NULL

[[57]]
NULL

[[58]]
NULL

[[59]]
NULL

[[60]]
NULL

[[61]]
NULL

[[62]]
NULL

[[63]]
NULL

[[64]]
NULL

[[65]]
NULL

[[66]]
NULL

[[67]]
NULL

[[68]]
NULL

[[69]]
NULL

[[70]]
NULL

[[71]]
NULL

[[72]]
NULL

[[73]]
NULL

[[74]]
NULL</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Lasonder sex-linked gene expression ------------------------------------------</span></span>
<span></span>
<span><span class='co'># See email from Danu on 2024-02-01:</span></span>
<span></span>
<span><span class='co'># "A previous study isolated RNAs that were highly expressed in either males or</span></span>
<span><span class='co'># females, and therefore based off their ratio in either sex classified genes</span></span>
<span><span class='co'># as being male or female specific. I’ve highlighted the Top100 male or female</span></span>
<span><span class='co'># genes in the attached file. Could we have a look at how these genes react in</span></span>
<span><span class='co'># the GIDKO samples compared to the wild type? This file is the Lasonder 2016 set."</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>male_genes_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"gene_lists"</span>, <span class='st'>"Lasonder 2016_Top100 male and female genes.xlsx"</span><span class='op'>)</span>,</span>
<span>  range <span class='op'>=</span> <span class='st'>"A2:E99"</span><span class='op'>)</span></span>
<span><span class='va'>male_genes_tbl</span><span class='op'>[</span><span class='op'>!</span><span class='va'>male_genes_tbl</span><span class='op'>$</span><span class='va'>`Male genes`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>"Male genes not tested in DE analysis."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Male genes not tested in DE analysis.</caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 57%" />
<col style="width: 11%" />
<col style="width: 10%" />
<col style="width: 8%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Male genes</th>
<th style="text-align: left;">…2</th>
<th style="text-align: right;">RPKM Male</th>
<th style="text-align: right;">RPKM Female</th>
<th style="text-align: right;">Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF3D7_1228100</td>
<td style="text-align: left;">leucine-rich repeat protein (LRR13)</td>
<td style="text-align: right;">34.220149</td>
<td style="text-align: right;">0.0573517</td>
<td style="text-align: right;">0.0016760</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1335400</td>
<td style="text-align: left;">reticulocyte binding protein 2 homologue a (RH2a)</td>
<td style="text-align: right;">13.232509</td>
<td style="text-align: right;">0.0410309</td>
<td style="text-align: right;">0.0031008</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1361400</td>
<td style="text-align: left;">actin-depolymerizing factor 2 (ADF2)</td>
<td style="text-align: right;">28.406013</td>
<td style="text-align: right;">0.0892137</td>
<td style="text-align: right;">0.0031407</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1235000</td>
<td style="text-align: left;">PIH1 domain-containing protein, putative (PIH1)</td>
<td style="text-align: right;">111.835985</td>
<td style="text-align: right;">0.4263311</td>
<td style="text-align: right;">0.0038121</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1215800</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">128.094732</td>
<td style="text-align: right;">0.5250726</td>
<td style="text-align: right;">0.0040991</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1477700</td>
<td style="text-align: left;">Plasmodium exported protein (PHISTa), unknown function (Pfg14-748)</td>
<td style="text-align: right;">396.727313</td>
<td style="text-align: right;">2.3317778</td>
<td style="text-align: right;">0.0058775</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1406500</td>
<td style="text-align: left;">WD repeat-containing protein 65, putative (WDR65)</td>
<td style="text-align: right;">53.396259</td>
<td style="text-align: right;">0.3278955</td>
<td style="text-align: right;">0.0061408</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1334300</td>
<td style="text-align: left;">MSP7-like protein (MSRP5)</td>
<td style="text-align: right;">53.865608</td>
<td style="text-align: right;">0.3351333</td>
<td style="text-align: right;">0.0062217</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1348700</td>
<td style="text-align: left;">WD repeat-containing protein 16, putative (WDR16)</td>
<td style="text-align: right;">75.470264</td>
<td style="text-align: right;">0.4844455</td>
<td style="text-align: right;">0.0064190</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1468300</td>
<td style="text-align: left;">leucine-rich repeat protein (LRR14.1)</td>
<td style="text-align: right;">53.628698</td>
<td style="text-align: right;">0.4110968</td>
<td style="text-align: right;">0.0076656</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0706700</td>
<td style="text-align: left;">DNA mismatch repair protein MSH2, putative (MSH2-2)</td>
<td style="text-align: right;">67.266806</td>
<td style="text-align: right;">0.7202426</td>
<td style="text-align: right;">0.0107073</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0111100</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">15.173801</td>
<td style="text-align: right;">0.1630761</td>
<td style="text-align: right;">0.0107472</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1353200</td>
<td style="text-align: left;">membrane associated histidine-rich protein (MAHRP2)</td>
<td style="text-align: right;">46.130719</td>
<td style="text-align: right;">0.5585555</td>
<td style="text-align: right;">0.0121081</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1201600</td>
<td style="text-align: left;">NIMA related kinase 3 (NEK3)</td>
<td style="text-align: right;">17813.515290</td>
<td style="text-align: right;">236.6317035</td>
<td style="text-align: right;">0.0132838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1014200</td>
<td style="text-align: left;">male gamete fusion factor HAP2, putative (HAP2)</td>
<td style="text-align: right;">16.182346</td>
<td style="text-align: right;">0.2453879</td>
<td style="text-align: right;">0.0151639</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1433500</td>
<td style="text-align: left;">DNA topoisomerase 2 (TOP2)</td>
<td style="text-align: right;">73.820192</td>
<td style="text-align: right;">1.1250741</td>
<td style="text-align: right;">0.0152407</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1440100</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">40.368959</td>
<td style="text-align: right;">0.6328461</td>
<td style="text-align: right;">0.0156766</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1127100</td>
<td style="text-align: left;">deoxyuridine 5’-triphosphate nucleotidohydrolase (dUTPase)</td>
<td style="text-align: right;">51.772893</td>
<td style="text-align: right;">0.8859845</td>
<td style="text-align: right;">0.0171129</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1245300</td>
<td style="text-align: left;">NEDD8-conjugating enzyme UBC12, putative (UBC12)</td>
<td style="text-align: right;">28.480593</td>
<td style="text-align: right;">0.4878522</td>
<td style="text-align: right;">0.0171293</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0208900</td>
<td style="text-align: left;">6-cysteine protein (P230p)</td>
<td style="text-align: right;">35.530554</td>
<td style="text-align: right;">0.6605158</td>
<td style="text-align: right;">0.0185901</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1016300</td>
<td style="text-align: left;">glycophorin binding protein (GBP)</td>
<td style="text-align: right;">192.902817</td>
<td style="text-align: right;">3.7372439</td>
<td style="text-align: right;">0.0193737</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1135600</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">104.977361</td>
<td style="text-align: right;">2.1117020</td>
<td style="text-align: right;">0.0201158</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1469900</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">10110.849684</td>
<td style="text-align: right;">208.9291431</td>
<td style="text-align: right;">0.0206639</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1226600</td>
<td style="text-align: left;">proliferating cell nuclear antigen 2 (PCNA2)</td>
<td style="text-align: right;">6.875112</td>
<td style="text-align: right;">0.1454352</td>
<td style="text-align: right;">0.0211539</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0202900</td>
<td style="text-align: left;">palmitoyltransferase, putative (DHHC12)</td>
<td style="text-align: right;">15.672707</td>
<td style="text-align: right;">0.3368069</td>
<td style="text-align: right;">0.0214900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0500800</td>
<td style="text-align: left;">mature parasite-infected erythrocyte surface antigen (MESA)</td>
<td style="text-align: right;">154.558636</td>
<td style="text-align: right;">3.5362205</td>
<td style="text-align: right;">0.0228795</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0507300</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">4.665920</td>
<td style="text-align: right;">0.1149600</td>
<td style="text-align: right;">0.0246382</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1440600</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">327.016544</td>
<td style="text-align: right;">8.1399829</td>
<td style="text-align: right;">0.0248917</td>
</tr>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>male_genes_tbl</span><span class='op'>[</span></span>
<span>  <span class='op'>!</span><span class='va'>male_genes_tbl</span><span class='op'>$</span><span class='va'>`Male genes`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&amp;</span></span>
<span>    <span class='va'>male_genes_tbl</span><span class='op'>$</span><span class='va'>`Male genes`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>"Male genes not tested in DE analysis but in dataset."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Male genes not tested in DE analysis but in dataset.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Male genes</th>
<th style="text-align: left;">…2</th>
<th style="text-align: right;">RPKM Male</th>
<th style="text-align: right;">RPKM Female</th>
<th style="text-align: right;">Ratio</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>female_genes_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"gene_lists"</span>, <span class='st'>"Lasonder 2016_Top100 male and female genes.xlsx"</span><span class='op'>)</span>,</span>
<span>  range <span class='op'>=</span> <span class='st'>"G2:K99"</span><span class='op'>)</span></span>
<span><span class='va'>female_genes_tbl</span><span class='op'>[</span><span class='op'>!</span><span class='va'>female_genes_tbl</span><span class='op'>$</span><span class='va'>`Female genes`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>"Female genes not tested in DE analysis."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Female genes not tested in DE analysis.</caption>
<colgroup>
<col style="width: 11%" />
<col style="width: 66%" />
<col style="width: 7%" />
<col style="width: 9%" />
<col style="width: 4%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Female genes</th>
<th style="text-align: left;">…2</th>
<th style="text-align: right;">RPKM Male</th>
<th style="text-align: right;">RPKM Female</th>
<th style="text-align: right;">Ratio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF3D7_0404400</td>
<td style="text-align: left;">6-cysteine protein (P36)</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">67.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0909500</td>
<td style="text-align: left;">subpellicular microtubule protein 1, putative (SPM1)</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">181.11</td>
<td style="text-align: right;">65.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0814600</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">16.92</td>
<td style="text-align: right;">60.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0709700</td>
<td style="text-align: left;">lysophospholipase, putative</td>
<td style="text-align: right;">4.03</td>
<td style="text-align: right;">239.46</td>
<td style="text-align: right;">59.45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1430700</td>
<td style="text-align: left;">NADP-specific glutamate dehydrogenase (GDH2)</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">18.48</td>
<td style="text-align: right;">57.55</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1022500</td>
<td style="text-align: left;">citrate synthase, mitochondrial precursor, putative (CS)</td>
<td style="text-align: right;">0.15</td>
<td style="text-align: right;">8.13</td>
<td style="text-align: right;">53.89</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1221400</td>
<td style="text-align: left;">inner membrane complex protein 1h, putative (IMC1h)</td>
<td style="text-align: right;">10.70</td>
<td style="text-align: right;">570.89</td>
<td style="text-align: right;">53.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0311700</td>
<td style="text-align: left;">plasmepsin VI</td>
<td style="text-align: right;">11.96</td>
<td style="text-align: right;">619.64</td>
<td style="text-align: right;">51.82</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0723100</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">27.58</td>
<td style="text-align: right;">50.35</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1027900</td>
<td style="text-align: left;">palmitoyltransferase, putative (DHHC10)</td>
<td style="text-align: right;">11.00</td>
<td style="text-align: right;">525.72</td>
<td style="text-align: right;">47.79</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0516500</td>
<td style="text-align: left;">metabolite/drug transporter, putative</td>
<td style="text-align: right;">14.00</td>
<td style="text-align: right;">636.65</td>
<td style="text-align: right;">45.49</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0109100</td>
<td style="text-align: left;">LCCL domain-containing protein (CCp5)</td>
<td style="text-align: right;">1.04</td>
<td style="text-align: right;">46.54</td>
<td style="text-align: right;">44.81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1331600</td>
<td style="text-align: left;">protein tyrosine phosphatase-like protein, putative (PTPLA)</td>
<td style="text-align: right;">4.50</td>
<td style="text-align: right;">199.88</td>
<td style="text-align: right;">44.44</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1426500</td>
<td style="text-align: left;">ABC transporter G family member 2 (ABCG2)</td>
<td style="text-align: right;">1.95</td>
<td style="text-align: right;">86.33</td>
<td style="text-align: right;">44.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1357200</td>
<td style="text-align: left;">glutamate–tRNA ligase</td>
<td style="text-align: right;">0.29</td>
<td style="text-align: right;">12.67</td>
<td style="text-align: right;">43.87</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1204400</td>
<td style="text-align: left;">conserved Plasmodium membrane protein, unknown function</td>
<td style="text-align: right;">13.83</td>
<td style="text-align: right;">597.30</td>
<td style="text-align: right;">43.17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1206100</td>
<td style="text-align: left;">IMP-specific 5’-nucleotidase, putative</td>
<td style="text-align: right;">0.94</td>
<td style="text-align: right;">39.90</td>
<td style="text-align: right;">42.58</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1115900</td>
<td style="text-align: left;">palmitoyltransferase, putative (DHHC9)</td>
<td style="text-align: right;">0.81</td>
<td style="text-align: right;">34.52</td>
<td style="text-align: right;">42.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1207300</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">5.30</td>
<td style="text-align: right;">219.68</td>
<td style="text-align: right;">41.41</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1351600</td>
<td style="text-align: left;">glycerol kinase (GK)</td>
<td style="text-align: right;">19.97</td>
<td style="text-align: right;">826.88</td>
<td style="text-align: right;">41.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1466100</td>
<td style="text-align: left;">protein phosphatase containing kelch-like domains (PPKL)</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">61.06</td>
<td style="text-align: right;">41.09</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0918600</td>
<td style="text-align: left;">ATP-dependent DNA helicase Q1 (RECQ1)</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">5.25</td>
<td style="text-align: right;">41.08</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0621400</td>
<td style="text-align: left;">Pf77 protein (ALV7)</td>
<td style="text-align: right;">5.28</td>
<td style="text-align: right;">208.54</td>
<td style="text-align: right;">39.47</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1230100</td>
<td style="text-align: left;">thioredoxin-like associated protein 1, putative (TLAP1)</td>
<td style="text-align: right;">5.03</td>
<td style="text-align: right;">195.54</td>
<td style="text-align: right;">38.84</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1034300</td>
<td style="text-align: left;">thioredoxin-like associated protein 2, putative (TLAP2)</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">30.77</td>
<td style="text-align: right;">38.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0903800</td>
<td style="text-align: left;">LCCL domain-containing protein (CCp4)</td>
<td style="text-align: right;">3.08</td>
<td style="text-align: right;">118.59</td>
<td style="text-align: right;">38.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0914700</td>
<td style="text-align: left;">transporter, putative</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">9.57</td>
<td style="text-align: right;">38.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1439000</td>
<td style="text-align: left;">copper transporter</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">34.57</td>
<td style="text-align: right;">38.01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1115200</td>
<td style="text-align: left;">SET domain protein, putative (SET7)</td>
<td style="text-align: right;">12.52</td>
<td style="text-align: right;">474.18</td>
<td style="text-align: right;">37.87</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1203200</td>
<td style="text-align: left;">signal recognition particle subunit SRP14 (SRP14)</td>
<td style="text-align: right;">10.45</td>
<td style="text-align: right;">395.68</td>
<td style="text-align: right;">37.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1250100</td>
<td style="text-align: left;">osmiophilic body protein (G377)</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;">23.75</td>
<td style="text-align: right;">37.55</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0828000</td>
<td style="text-align: left;">rhomboid protease ROM3 (ROM3)</td>
<td style="text-align: right;">4.36</td>
<td style="text-align: right;">162.74</td>
<td style="text-align: right;">37.36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1315700</td>
<td style="text-align: left;">tRNA (adenine(58)-N(1))-methyltransferase catalytic subunit TRM61, putative (GCD14)</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">41.01</td>
<td style="text-align: right;">37.30</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0907900</td>
<td style="text-align: left;">peptide deformylase (PDF)</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">37.32</td>
<td style="text-align: right;">37.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1003600</td>
<td style="text-align: left;">inner membrane complex protein 1c, putative (IMC1c)</td>
<td style="text-align: right;">9.58</td>
<td style="text-align: right;">354.20</td>
<td style="text-align: right;">36.99</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0505200</td>
<td style="text-align: left;">actin-like protein, putative (ALP2b)</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">5.77</td>
<td style="text-align: right;">36.55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0805200</td>
<td style="text-align: left;">gamete release protein, putative (GAMER)</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">21.18</td>
<td style="text-align: right;">36.41</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1310700</td>
<td style="text-align: left;">RNA-binding protein, putative</td>
<td style="text-align: right;">12.10</td>
<td style="text-align: right;">437.50</td>
<td style="text-align: right;">36.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1453500</td>
<td style="text-align: left;">pyridine nucleotide transhydrogenase, putative</td>
<td style="text-align: right;">5.58</td>
<td style="text-align: right;">200.43</td>
<td style="text-align: right;">35.95</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1213500</td>
<td style="text-align: left;">integral membrane protein GPR180, putative</td>
<td style="text-align: right;">2.62</td>
<td style="text-align: right;">93.57</td>
<td style="text-align: right;">35.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0630200</td>
<td style="text-align: left;">secreted ookinete protein, putative (PSOP6)</td>
<td style="text-align: right;">94.06</td>
<td style="text-align: right;">3351.21</td>
<td style="text-align: right;">35.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1031000</td>
<td style="text-align: left;">25 kDa ookinete surface antigen precursor (Pfs25)</td>
<td style="text-align: right;">206.36</td>
<td style="text-align: right;">7341.64</td>
<td style="text-align: right;">35.58</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1246400</td>
<td style="text-align: left;">myosin A tail domain interacting protein (MTIP)</td>
<td style="text-align: right;">23.99</td>
<td style="text-align: right;">835.60</td>
<td style="text-align: right;">34.83</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0913900</td>
<td style="text-align: left;">arginine–tRNA ligase, putative</td>
<td style="text-align: right;">0.42</td>
<td style="text-align: right;">14.48</td>
<td style="text-align: right;">34.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0611600</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">6.20</td>
<td style="text-align: right;">213.26</td>
<td style="text-align: right;">34.38</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1335900</td>
<td style="text-align: left;">thrombospondin-related anonymous protein (TRAP)</td>
<td style="text-align: right;">1.10</td>
<td style="text-align: right;">37.83</td>
<td style="text-align: right;">34.28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1315600</td>
<td style="text-align: left;">CDP-diacylglycerol–inositol 3-phosphatidyltransferase (PIS)</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">33.89</td>
<td style="text-align: right;">34.14</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1448900</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">3.47</td>
<td style="text-align: right;">118.16</td>
<td style="text-align: right;">34.09</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0518800</td>
<td style="text-align: left;">secreted ookinete protein, putative (PSOP13)</td>
<td style="text-align: right;">48.14</td>
<td style="text-align: right;">1633.18</td>
<td style="text-align: right;">33.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0924800</td>
<td style="text-align: left;">telomeric repeat binding factor 1, putative (TRF1)</td>
<td style="text-align: right;">3.55</td>
<td style="text-align: right;">120.46</td>
<td style="text-align: right;">33.91</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1141900</td>
<td style="text-align: left;">inner membrane complex protein 1b, putative (IMC1b)</td>
<td style="text-align: right;">4.62</td>
<td style="text-align: right;">156.68</td>
<td style="text-align: right;">33.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1006000</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">34.35</td>
<td style="text-align: right;">1163.25</td>
<td style="text-align: right;">33.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0609100</td>
<td style="text-align: left;">Zn2+ or Fe2+ permease</td>
<td style="text-align: right;">5.53</td>
<td style="text-align: right;">184.83</td>
<td style="text-align: right;">33.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0729200</td>
<td style="text-align: left;">1-cys peroxiredoxin (AOP)</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">7.57</td>
<td style="text-align: right;">33.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0825700</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">18.84</td>
<td style="text-align: right;">624.24</td>
<td style="text-align: right;">33.13</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1471600</td>
<td style="text-align: left;">conserved Plasmodium protein, unknown function</td>
<td style="text-align: right;">11.57</td>
<td style="text-align: right;">378.82</td>
<td style="text-align: right;">32.73</td>
</tr>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>female_genes_tbl</span><span class='op'>[</span></span>
<span>  <span class='op'>!</span><span class='va'>female_genes_tbl</span><span class='op'>$</span><span class='va'>`Female genes`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&amp;</span></span>
<span>    <span class='va'>female_genes_tbl</span><span class='op'>$</span><span class='va'>`Female genes`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>"Female genes not tested in DE analysis but in dataset."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Female genes not tested in DE analysis but in dataset.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Female genes</th>
<th style="text-align: left;">…2</th>
<th style="text-align: right;">RPKM Male</th>
<th style="text-align: right;">RPKM Female</th>
<th style="text-align: right;">Ratio</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Male genes</span></span>
<span><span class='va'>male_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>male_genes_tbl</span><span class='op'>$</span><span class='va'>`Male genes`</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>lcpm</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># 1. Samples ordered by `group`.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>male_genes</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Lasonder male genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_male_genes.ordered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>male_genes</span>, <span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Lasonder male genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>    timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_male_genes.clustered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Female genes</span></span>
<span><span class='va'>female_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>female_genes_tbl</span><span class='op'>$</span><span class='va'>`Female genes`</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>lcpm</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># 1. Samples ordered by `group`.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>female_genes</span>, <span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Lasonder female genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_female_genes.ordered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>female_genes</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Lasonder female genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>    timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_female_genes.clustered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Male and female</span></span>
<span><span class='va'>lasonder_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>male_genes</span>, <span class='va'>female_genes</span><span class='op'>)</span></span>
<span><span class='co'># 1. Samples ordered by `group`.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>lasonder_genes</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>  annotation_row <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>    sex <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Male"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>male_genes</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Female"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>female_genes</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    row.names <span class='op'>=</span> <span class='va'>lasonder_genes</span><span class='op'>)</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Lasonder sex genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    group <span class='op'>=</span> <span class='va'>group_colours</span>,</span>
<span>    sex <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>Male <span class='op'>=</span> <span class='st'>"skyblue3"</span>, Female <span class='op'>=</span> <span class='st'>"deeppink"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_sex_genes.ordered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>lasonder_genes</span>, <span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  annotation_row <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>    sex <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Male"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>male_genes</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"Female"</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>female_genes</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    row.names <span class='op'>=</span> <span class='va'>lasonder_genes</span><span class='op'>)</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Lasonder sex genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    group <span class='op'>=</span> <span class='va'>group_colours</span>,</span>
<span>    sex <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>Male <span class='op'>=</span> <span class='st'>"skyblue3"</span>, Female <span class='op'>=</span> <span class='st'>"deeppink"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_sex_genes.clustered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Formal gene set analysis of Lasonder sex genes.</span></span>
<span><span class='va'>lasonder_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ids2indices.html'>ids2indices</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>male <span class='op'>=</span> <span class='va'>male_genes</span>, female <span class='op'>=</span> <span class='va'>female_genes</span>, lasonder <span class='op'>=</span> <span class='va'>lasonder_genes</span><span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder.barcodeplots.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span></span>
<span><span class='va'>l_of_fry</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='co'># TODO: Incorporate gene.weights? Something like log(Ratio) where Ratio comes</span></span>
<span>  <span class='co'>#       from male_genes_tbl and female_genes_tbl?</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/barcodeplot.html'>barcodeplot</a></span><span class='op'>(</span></span>
<span>    statistics <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>lasonder_index</span><span class='op'>$</span><span class='va'>female</span>,</span>
<span>    index2 <span class='op'>=</span> <span class='va'>lasonder_index</span><span class='op'>$</span><span class='va'>male</span>,</span>
<span>    xlab <span class='op'>=</span> <span class='st'>"t"</span>,</span>
<span>    col.bars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"deeppink"</span>, <span class='st'>"skyblue3"</span><span class='op'>)</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/barcodeplot.html'>barcodeplot</a></span><span class='op'>(</span></span>
<span>    statistics <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>lasonder_index</span><span class='op'>$</span><span class='va'>lasonder</span>,</span>
<span>    xlab <span class='op'>=</span> <span class='st'>"t"</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>j</span>,</span>
<span>    sub <span class='op'>=</span> <span class='st'>"Lasander male and female genes"</span><span class='op'>)</span></span>
<span>  <span class='co'># NOTE: fry() is a self-contained gene set test.</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/roast.html'>fry</a></span><span class='op'>(</span></span>
<span>    y <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>EList</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>lasonder_index</span>,</span>
<span>    design <span class='op'>=</span> <span class='va'>design</span>,</span>
<span>    contrast <span class='op'>=</span> <span class='va'>cm</span><span class='op'>[</span>, <span class='va'>j</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>pdf 
  3 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>l_of_fry</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span></span>
<span><span class='co'># TODO: Male genes start to 'flatline' in the barcode plots by the time we get</span></span>
<span><span class='co'>#       to the Day_12_vs_Day_9 comparisons. This is more obvious in some cell</span></span>
<span><span class='co'>#       lines (e.g., WTs) than others; discuss with Danu.</span></span>
<span><span class='co'># TODO: The KO vs WT comparisons at Day 9 and Day 12 show downregulation of</span></span>
<span><span class='co'>#       sex-specific genes, particularly female-specific genes, in KOs;</span></span>
<span><span class='co'>#       discuss with Danu.</span></span>
<span></span>
<span><span class='va'>fry_female_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>rbind</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>l_of_fry</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>fry</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>fry</span><span class='op'>[</span><span class='st'>"female"</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>fry_male_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>rbind</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>l_of_fry</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>fry</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>fry</span><span class='op'>[</span><span class='st'>"male"</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>fry_lasonnder_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>rbind</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>l_of_fry</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>fry</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>fry</span><span class='op'>[</span><span class='st'>"lasonder"</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># TODO: Look at the 'most significant' comparisons; discuss with Danu.</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_lasonnder_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_lasonnder_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_lasonnder_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                                    NGenes Direction       PValue
KOs_except_GID1.Day_12_vs_WT.Day_12    110      Down 3.293755e-85
KOs.Day_12_vs_WT.Day_12                110      Down 1.561490e-82
KOs_except_GID9.Day_12_vs_WT.Day_12    110      Down 2.338305e-80
GID8KO.Day_12_vs_WT.Day_12             110      Down 3.655567e-77
KOs.Day_9_vs_WT.Day_9                  110      Down 8.860869e-77
KOs_except_GID1.Day_9_vs_WT.Day_9      110      Down 4.774764e-76
                                             FDR  PValue.Mixed
KOs_except_GID1.Day_12_vs_WT.Day_12 4.940633e-85 3.454480e-127
KOs.Day_12_vs_WT.Day_12             2.342235e-82 1.087728e-128
KOs_except_GID9.Day_12_vs_WT.Day_12 3.507457e-80 4.558056e-129
GID8KO.Day_12_vs_WT.Day_12          5.483350e-77 6.009062e-127
KOs.Day_9_vs_WT.Day_9               2.658261e-76 2.912779e-129
KOs_except_GID1.Day_9_vs_WT.Day_9   1.432429e-75 2.481293e-130
                                        FDR.Mixed
KOs_except_GID1.Day_12_vs_WT.Day_12 1.036344e-126
KOs.Day_12_vs_WT.Day_12             3.263183e-128
KOs_except_GID9.Day_12_vs_WT.Day_12 1.367417e-128
GID8KO.Day_12_vs_WT.Day_12          1.802719e-126
KOs.Day_9_vs_WT.Day_9               8.738338e-129
KOs_except_GID1.Day_9_vs_WT.Day_9   7.443878e-130</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_lasonnder_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_lasonnder_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_lasonnder_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                              NGenes Direction       PValue
WT.Day_9_vs_WT.Day_6             110        Up 3.727252e-68
GID1KO.Day_9_vs_GID1KO.Day_6     110        Up 1.978753e-45
GID1KO.Day_6_vs_GID1KO.Day_3     110        Up 3.394900e-45
GID1KO.Day_12_vs_GID1KO.Day_9    110        Up 1.079301e-43
GID2KO.Day_6_vs_GID2KO.Day_3     110        Up 6.360755e-42
GID7KO.Day_6_vs_GID7KO.Day_3     110        Up 9.122134e-42
                                       FDR  PValue.Mixed
WT.Day_9_vs_WT.Day_6          1.118175e-67 1.496330e-129
GID1KO.Day_9_vs_GID1KO.Day_6  5.936259e-45 4.494292e-160
GID1KO.Day_6_vs_GID1KO.Day_3  1.018470e-44 2.041029e-147
GID1KO.Day_12_vs_GID1KO.Day_9 3.237903e-43 1.899313e-139
GID2KO.Day_6_vs_GID2KO.Day_3  1.908226e-41 5.123564e-148
GID7KO.Day_6_vs_GID7KO.Day_3  2.736640e-41 8.484500e-144
                                  FDR.Mixed
WT.Day_9_vs_WT.Day_6          4.488989e-129
GID1KO.Day_9_vs_GID1KO.Day_6  1.348288e-159
GID1KO.Day_6_vs_GID1KO.Day_3  6.123088e-147
GID1KO.Day_12_vs_GID1KO.Day_9 5.697940e-139
GID2KO.Day_6_vs_GID2KO.Day_3  1.537069e-147
GID7KO.Day_6_vs_GID7KO.Day_3  2.545350e-143</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_female_df</span>,</span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_female_genes.fry.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_male_df</span>,</span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_male_genes.fry.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_lasonnder_df</span>,</span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Lasonder"</span>, <span class='st'>"Lasonder_sex_genes.fry.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Guerreiro transcriptional repression program gene expression -----------------</span></span>
<span></span>
<span><span class='co'># See email from Danu on 2024-02-01:</span></span>
<span></span>
<span><span class='co'># "We would like to look at genes that are known to be regulated by a</span></span>
<span><span class='co'>#  transcriptional repression programme in Plasmodium. I’ve attached the genes</span></span>
<span><span class='co'>#  of interest in here as well. Could we look at how they relate to the GIDKO</span></span>
<span><span class='co'>#  parasites at Day3/6/9/12? I’m sure they would be altered at Day 12 in the KO</span></span>
<span><span class='co'>#  samples compared to WT as those parasites are arrested at an earlier</span></span>
<span><span class='co'>#  developmental stage. This file is the Guerreiro 2014 set."</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Guerreiro"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># TODO: Is there a version of this dataset with logFCs?</span></span>
<span><span class='va'>transcriptional_repression_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"data"</span>,</span>
<span>    <span class='st'>"gene_lists"</span>,</span>
<span>    <span class='st'>"Guerreiro 2014_Genes common to DOZI and CITH IP and down regulated in DOZI KO.xlsx"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>transcriptional_repression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>transcriptional_repression_tbl</span><span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>transcriptional_repression_tbl</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>transcriptional_repression</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='cn'>NULL</span></span>
<span><span class='va'>transcriptional_repression</span> <span class='op'>&lt;-</span> <span class='va'>transcriptional_repression</span><span class='op'>[</span></span>
<span>  <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>transcriptional_repression</span><span class='op'>)</span><span class='op'>]</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>gene <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>transcriptional_repression</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span></span>
<span>    caption <span class='op'>=</span> <span class='st'>"Guerreiro transcriptional repression program not tested in DE analysis."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Guerreiro transcriptional repression program not tested in DE analysis.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">gene</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF3D7_1333000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1142800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0515700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1342800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0909500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0816600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1031000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1030900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1027600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0915800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1414000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0817900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1128200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1403600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1210900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1147800.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1323700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1141900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0525800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1221400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1439000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0516500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0523000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1436300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0813800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0807300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1320600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0211200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0903200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1231100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0816800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1426500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0823900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0603300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1346100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0210000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1216600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1208600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0928000.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1342600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1234800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1143100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1119300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1444300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0404400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0404900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1238800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0905700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1312600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0904900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1356900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0623000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0315200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0904200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1028900</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pf3D7_1038200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1204400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0411000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0720300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0825700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0818600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0914400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1135300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_01415900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0510300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0528000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1447500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1448900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1458100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1471500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1473000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1341800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0814600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1219800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1230100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0402500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1117600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1234700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1458000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1027900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0319100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0614800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0528200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0423500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1406800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1222700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1351600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1417500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0213100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1003600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0708600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0304100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0903800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1455800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0618500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0823500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0914700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0527300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0925200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1031200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1315800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1246400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0526300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1146000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1407500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1115600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0528700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0621400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1018500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1219700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1470500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1022700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0311700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1465700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1030100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1316000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1455100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0810500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0214100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0821800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1246900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1107400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1029800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1308800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1213700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1002400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0922200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0518800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0715400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0630200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1415700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0214600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0927700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1238600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0625100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0924800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1457200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1449500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0530200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0818800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0915100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0801300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1217800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0609800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1121000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1116500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1230400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1309500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>gene <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>setdiff</a></span><span class='op'>(</span><span class='va'>transcriptional_repression</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span></span>
<span>    caption <span class='op'>=</span> <span class='st'>"Guerreiro transcriptional repression program not tested in DE analysis but in dataset."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>Guerreiro transcriptional repression program not tested in DE analysis but in dataset.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">gene</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF3D7_0720300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1473000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1219800</td>
</tr>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>transcriptional_repression</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span></span>
<span>  <span class='va'>transcriptional_repression</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># 1. Samples ordered by `group`.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>transcriptional_repression</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Guerreiro genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Guerreiro"</span>, <span class='st'>"Guerreiro_genes.ordered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>transcriptional_repression</span>, <span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Guerreiro genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>    timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Guerreiro"</span>, <span class='st'>"Guerreiro_genes.clustered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Formal gene set analysis of Lasonder sex genes.</span></span>
<span><span class='va'>guerreiro_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ids2indices.html'>ids2indices</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>guerreiro <span class='op'>=</span> <span class='va'>transcriptional_repression</span><span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Guerreiro"</span>, <span class='st'>"Guerreiro.barcodeplots.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span></span>
<span><span class='va'>l_of_fry</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='co'># TODO: Incorporate gene.weights? Don't have logFCs, but will ask.</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/barcodeplot.html'>barcodeplot</a></span><span class='op'>(</span></span>
<span>    statistics <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>guerreiro_index</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,</span>
<span>    xlab <span class='op'>=</span> <span class='st'>"t"</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>j</span>,</span>
<span>    sub <span class='op'>=</span> <span class='st'>"Guerreiro transcriptional repression program genes"</span><span class='op'>)</span></span>
<span>  <span class='co'># NOTE: fry() is a self-contained gene set test.</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/roast.html'>fry</a></span><span class='op'>(</span></span>
<span>    y <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>EList</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>guerreiro_index</span>,</span>
<span>    design <span class='op'>=</span> <span class='va'>design</span>,</span>
<span>    contrast <span class='op'>=</span> <span class='va'>cm</span><span class='op'>[</span>, <span class='va'>j</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>pdf 
  3 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>l_of_fry</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span></span>
<span><span class='va'>fry_guerreiro_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>rbind</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>l_of_fry</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>fry</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>fry</span><span class='op'>[</span><span class='st'>"guerreiro"</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># TODO: Look at the 'most significant' comparisons; discuss with Danu.</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_guerreiro_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_guerreiro_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_lasonnder_df</span><span class='op'>$</span><span class='va'>PValue</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                                    NGenes Direction       PValue
KOs_except_GID1.Day_12_vs_WT.Day_12    140      Down 4.874336e-82
KOs.Day_12_vs_WT.Day_12                140      Down 9.084318e-82
KOs_except_GID9.Day_12_vs_WT.Day_12    140      Down 9.759295e-80
GID8KO.Day_12_vs_WT.Day_12             140      Down 1.331768e-71
KOs.Day_9_vs_WT.Day_9                  140      Down 2.465669e-60
KOs_except_GID1.Day_9_vs_WT.Day_9      140      Down 4.340974e-59
                                     PValue.Mixed
KOs_except_GID1.Day_12_vs_WT.Day_12 1.043147e-132
KOs.Day_12_vs_WT.Day_12             1.086382e-132
KOs_except_GID9.Day_12_vs_WT.Day_12 6.511994e-133
GID8KO.Day_12_vs_WT.Day_12          5.694523e-136
KOs.Day_9_vs_WT.Day_9               7.698421e-144
KOs_except_GID1.Day_9_vs_WT.Day_9   8.170333e-145</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_guerreiro_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_guerreiro_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_lasonnder_df</span><span class='op'>$</span><span class='va'>PValue</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                              NGenes Direction       PValue
WT.Day_9_vs_WT.Day_6             140        Up 1.470379e-55
GID1KO.Day_9_vs_GID1KO.Day_6     140        Up 1.386347e-32
GID1KO.Day_6_vs_GID1KO.Day_3     140        Up 1.134184e-31
GID1KO.Day_12_vs_GID1KO.Day_9    140        Up 4.047783e-14
GID2KO.Day_6_vs_GID2KO.Day_3     140        Up 1.691175e-26
GID7KO.Day_6_vs_GID7KO.Day_3     140        Up 2.685559e-26
                               PValue.Mixed
WT.Day_9_vs_WT.Day_6          4.171670e-142
GID1KO.Day_9_vs_GID1KO.Day_6  1.863944e-156
GID1KO.Day_6_vs_GID1KO.Day_3  2.245141e-159
GID1KO.Day_12_vs_GID1KO.Day_9 6.195214e-129
GID2KO.Day_6_vs_GID2KO.Day_3  5.631914e-158
GID7KO.Day_6_vs_GID7KO.Day_3  2.863246e-161</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_guerreiro_df</span>,</span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Guerreiro"</span>, <span class='st'>"Guerreiro_genes.fry.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Processing bodies (P-body), mRNA binding proteins &amp; Translation gene sets ----</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Pbody_mRNA_translation"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># See email from Danu on 2024-11-25:</span></span>
<span></span>
<span><span class='co'># "Here are the lists of the genes we are looking at. There are 3 gene sets all together [Translation, mRNA binding proteins, Processing bodies (P-body)].</span></span>
<span><span class='co'># Could we assemble barcode plots for these sets similar to what you previously did for the Guerreiro (translational repression genes) and the Lasonder (male and female specific markers)?</span></span>
<span><span class='co'># The data sets we’re most interested in comparing are:</span></span>
<span><span class='co'>#</span></span>
<span><span class='co'># - All knockouts vs WT at Day 3</span></span>
<span><span class='co'># - All knockouts vs WT at Day 6</span></span>
<span><span class='co'># - All knockouts vs WT at Day 9</span></span>
<span><span class='co'># - All knockouts vs WT at Day 12"</span></span>
<span></span>
<span><span class='va'>pbody_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"gene_lists"</span>, <span class='st'>"Danu_Barcode_updated.xlsx"</span><span class='op'>)</span>,</span>
<span>  sheet <span class='op'>=</span> <span class='st'>"Pbody"</span><span class='op'>)</span></span>
<span><span class='va'>pbody_tbl</span><span class='op'>[</span><span class='op'>!</span><span class='va'>pbody_tbl</span><span class='op'>$</span><span class='va'>Plasmodium_Pbody</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span>caption <span class='op'>=</span> <span class='st'>"'Processing body' genes not tested in DE analysis."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>‘Processing body’ genes not tested in DE analysis.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Plasmodium_Pbody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF3D7_0109200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0213100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0302100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0315100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0317600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0320800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0322900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0405100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0408300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0418500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0422400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0422500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0422700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0507100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0507600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0517300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0517700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0519500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0520300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0521700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0526200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0528200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0606500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0610200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0612100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0707400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0716800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0719200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0719700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0727300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0728000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0806400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0810600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0811300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0812400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0815600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0818200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0819900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0822600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0826700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0829300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0912800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0917100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0925800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1002400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1005500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1006100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1006800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1008000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1015600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1030100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1032100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1103800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1105000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1105700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1107000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1107300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1114700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1117700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1121700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1128600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1136500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1204300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1206200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1211400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1212700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1213800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1224300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1235300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1236100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1246900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1307800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1308900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1312900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1321700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1323400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1325000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1329100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1332300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1337800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1347100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1350100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1352700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1356900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1359300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1359400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1360100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1361100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1407100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1409800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1417500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1426200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1429900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1434300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1434600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1437800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1437900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1442300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1443300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1445900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1457200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1459000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1468700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1474900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1475600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0814200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1346300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1006200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1347500</td>
</tr>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>pbody_tbl</span><span class='op'>[</span></span>
<span>  <span class='op'>!</span><span class='va'>pbody_tbl</span><span class='op'>$</span><span class='va'>Plasmodium_Pbody</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&amp;</span></span>
<span>    <span class='va'>pbody_tbl</span><span class='op'>$</span><span class='va'>Plasmodium_Pbody</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span></span>
<span>    caption <span class='op'>=</span> <span class='st'>"'Processing body' genes not tested in DE analysis but in dataset."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>‘Processing body’ genes not tested in DE analysis but in dataset.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Plasmodium_Pbody</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mrna_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"gene_lists"</span>, <span class='st'>"Danu_Barcode_updated.xlsx"</span><span class='op'>)</span>,</span>
<span>  sheet <span class='op'>=</span> <span class='st'>"mRNA"</span><span class='op'>)</span></span>
<span><span class='va'>mrna_tbl</span><span class='op'>[</span><span class='op'>!</span><span class='va'>mrna_tbl</span><span class='op'>$</span><span class='va'>`Plasmodium Identifiers`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span></span>
<span>    caption <span class='op'>=</span> <span class='st'>"'mRNA binding protein' genes not tested in DE analysis."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>‘mRNA binding protein’ genes not tested in DE analysis.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Plasmodium Identifiers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF3D7_API02900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0827100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1312400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1123400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0106700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0110100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0602400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0516600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1410600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1451100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1233000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1003800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0605100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1469300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1011800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0916700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0920900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0923900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0935000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0815600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1306900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1310700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1321700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1359400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1360100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1367100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1119800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1126800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0610200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0615700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0629400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0503300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0517300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0517700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0415500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1402700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1406000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1409800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1420000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1468800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1217200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1224300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1224900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1236100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1248200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1002400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1006800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1020000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1022400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1209300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0903400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0917600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0918600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0807100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0810600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0821300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0827000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0721300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1307300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1331100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1332700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1364300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0103600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0310500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0320800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0321600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0602100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0630900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0504200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0508700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0518500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0521700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0527900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0405000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0422500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0422700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1418900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1419100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1429900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1445200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1445900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1459000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1468700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1202000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1227100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1231600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1241800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1251500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0209800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0218400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1021500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1030100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1031500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1342100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0932400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0704900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1117600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0409700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1428600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1136300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1136300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0728000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1027400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1030100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0514100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0408300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1119300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1134600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1443800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1464200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1338300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1224300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1342100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0825200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0913200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0319600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0906000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1359300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0518700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0417100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1227900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0305000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1471000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1340100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1364500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1427800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0209200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1469000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1204300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1203500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1414600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0909800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0819900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0822300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0829300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1325000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1350200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1107000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1124400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1125500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1126900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0520300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1414800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1443300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1209200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0218500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1417500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_API00100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0520000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1461200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0610200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1417500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1411400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1362500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0315100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1118500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0409100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1008800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1402700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1474500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1206700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1010600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0621500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0814200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1346300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1006200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1412300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0908000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0922700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1238300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0322100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0810200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1414500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_API02900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1123400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_API02900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0110100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0602400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1410600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1451100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1233000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1003800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1106300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1234800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0323700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1132600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1407300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1363500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0107200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0305600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0319200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0519500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1238600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0722100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0212300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0722100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0212300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0722100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0212300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1327700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0719700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1018500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1340100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1364500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0602400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1451100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1233000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1003800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1414600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1247900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0802300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1327200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1103800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1417200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0623400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0912800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0917600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0821300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1364300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1231600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1030100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1309500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1220400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1220400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0811300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1443500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0722500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0625600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0729300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1308900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0729500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1235500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1007900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1206200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1032100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1030000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0812700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1472000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1110200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0711400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1107700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1225100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0709600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1355800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1438500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0728000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1030100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0917600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0821300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1364300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1231600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1118500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1008800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1235000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0803000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0105200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0518100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1470600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1029800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1309300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0308600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1307100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0517700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0922700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1343900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0308900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1410600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1005500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1202500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1474900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1246600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0409100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0720000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0512900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1438500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1249800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0610100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1118600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1438500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1033600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0827100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1312400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0516600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0924700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0405400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1367100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1474500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0815600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0623700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1474900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0619900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0109200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0935000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1306900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1321700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1119300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0606500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0515000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1235300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0606500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1409800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1468800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1217200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1236100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0720000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0623100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1125300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0519000</td>
</tr>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>mrna_tbl</span><span class='op'>[</span></span>
<span>  <span class='op'>!</span><span class='va'>mrna_tbl</span><span class='op'>$</span><span class='va'>`Plasmodium Identifiers`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&amp;</span></span>
<span>    <span class='va'>mrna_tbl</span><span class='op'>$</span><span class='va'>`Plasmodium Identifiers`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span></span>
<span>    caption <span class='op'>=</span> <span class='st'>"'mRNA binding protein' genes not tested in DE analysis but in dataset."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>‘mRNA binding protein’ genes not tested in DE analysis but in dataset.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Plasmodium Identifiers</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>translation_tbl</span> <span class='op'>&lt;-</span> <span class='fu'>readxl</span><span class='fu'>::</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"data"</span>, <span class='st'>"gene_lists"</span>, <span class='st'>"Danu_Barcode_updated.xlsx"</span><span class='op'>)</span>,</span>
<span>  sheet <span class='op'>=</span> <span class='st'>"Translation"</span><span class='op'>)</span></span>
<span><span class='va'>translation_tbl</span><span class='op'>[</span><span class='op'>!</span><span class='va'>translation_tbl</span><span class='op'>$</span><span class='va'>`Gene ID`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span></span>
<span>    caption <span class='op'>=</span> <span class='st'>"'Translation' genes not tested in DE analysis."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>‘Translation’ genes not tested in DE analysis.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Gene ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PF3D7_0103700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0109800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0110100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0211800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0212300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0214200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0217800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0304400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0305000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0307100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0309600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0315100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0317600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0319600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0322900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0412100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0418200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0420400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0422400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0503800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0507100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0509600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0515100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0516600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0516900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0517700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0519400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0520000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0522500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0524400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0528200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0602400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0603700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0611700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0612100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0614500</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0628800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0706400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0710600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0710900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0716800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0728000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0803100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0807900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0813900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0815600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0826700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0827100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0903900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0907900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0913200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0913900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_0918300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_0925300</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1005000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1007900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1010600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1015200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1026800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1027800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1034200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1034900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1103100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1105400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1107300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1109900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1117500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1117600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1123400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1124900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1126200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1130100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1130200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1132700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1142500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1144000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1204300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1205100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1206200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1206700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1210000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1212700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1213800</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1218600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1225100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1232000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1233000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1251700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1312400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1312900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1313200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1317800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1323400</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1332900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1336900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1338200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1349200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1350100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1357200</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1358800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1367700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1368200</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1410600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1416800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1419700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1420400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1424100</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1426000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1442300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1451100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1460300</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1460700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1460900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_1467400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_1468700</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_API00100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_API01500</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_API01800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_API02000</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_API02700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PF3D7_API02900</td>
</tr>
<tr class="even">
<td style="text-align: left;">PF3D7_API04100</td>
</tr>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>translation_tbl</span><span class='op'>[</span></span>
<span>  <span class='op'>!</span><span class='va'>translation_tbl</span><span class='op'>$</span><span class='va'>`Gene ID`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span> <span class='op'>&amp;</span></span>
<span>    <span class='va'>translation_tbl</span><span class='op'>$</span><span class='va'>`Gene ID`</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>sce</span><span class='op'>)</span>, <span class='op'>]</span> <span class='op'>|&gt;</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span></span>
<span>    caption <span class='op'>=</span> <span class='st'>"'Translation' genes not tested in DE analysis but in dataset."</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 1: </span>‘Translation’ genes not tested in DE analysis but in dataset.</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Gene ID</th>
</tr>
</thead>
<tbody>
</tbody>
</table>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Processing body genes</span></span>
<span><span class='va'>pbody_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>pbody_tbl</span><span class='op'>$</span><span class='va'>Plasmodium_Pbody</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>lcpm</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># 1. Samples ordered by `group`.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>pbody_genes</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"'Processing body' genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"output"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation"</span>,</span>
<span>    <span class='st'>"Processing_body_genes.ordered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>pbody_genes</span>, <span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"Lasonder male genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>    timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"output"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation"</span>,</span>
<span>    <span class='st'>"Processing_body_genes.clustered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># mRNA binding protein genes</span></span>
<span><span class='va'>mrna_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>mrna_tbl</span><span class='op'>$</span><span class='va'>`Plasmodium Identifiers`</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>lcpm</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># 1. Samples ordered by `group`.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>mrna_genes</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"'mRNA binding protein' genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"output"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation"</span>,</span>
<span>    <span class='st'>"mRNA_binding_protein_genes.ordered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>mrna_genes</span>, <span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"'mRNA binding protein' genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>    timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"output"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation"</span>,</span>
<span>    <span class='st'>"mRNA_binding_protein_genes.clustered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Translation genes</span></span>
<span><span class='va'>translation_genes</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sets.html'>intersect</a></span><span class='op'>(</span><span class='va'>translation_tbl</span><span class='op'>$</span><span class='va'>`Gene ID`</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>lcpm</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='co'># 1. Samples ordered by `group`.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>translation_genes</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"'Translation' genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"output"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation"</span>,</span>
<span>    <span class='st'>"Translation_genes.ordered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span><span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>  <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>translation_genes</span>, <span class='op'>]</span>,</span>
<span>  scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>  color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>  fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>  annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>  main <span class='op'>=</span> <span class='st'>"'Translation' genes"</span>,</span>
<span>  annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>    cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>    timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>)</span>,</span>
<span>  angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>  treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>  cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"output"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation"</span>,</span>
<span>    <span class='st'>"Translation_genes.clustered.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Formal gene set analysis of P-body, mRNA binding protein, and translation</span></span>
<span><span class='co'># genes</span></span>
<span><span class='va'>pbody_mrna_translation_index</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ids2indices.html'>ids2indices</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>pbody <span class='op'>=</span> <span class='va'>pbody_genes</span>, mrna <span class='op'>=</span> <span class='va'>mrna_genes</span>, translation <span class='op'>=</span> <span class='va'>translation_genes</span><span class='op'>)</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"output"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation"</span>,</span>
<span>    <span class='st'>"Pbody_mRNA_translation.barcodeplots.pdf"</span><span class='op'>)</span>,</span>
<span>  width <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>  height <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span></span>
<span><span class='va'>l_of_fry</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>j</span><span class='op'>)</span></span>
<span>  <span class='co'># TODO: Incorporate gene.weights? Something like log(Ratio) where Ratio comes</span></span>
<span>  <span class='co'>#       from male_genes_tbl and female_genes_tbl?</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/barcodeplot.html'>barcodeplot</a></span><span class='op'>(</span></span>
<span>    statistics <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>pbody_mrna_translation_index</span><span class='op'>$</span><span class='va'>pbody</span>,</span>
<span>    xlab <span class='op'>=</span> <span class='st'>"t"</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>j</span>,</span>
<span>    sub <span class='op'>=</span> <span class='st'>"'Processing bodies' genes"</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/barcodeplot.html'>barcodeplot</a></span><span class='op'>(</span></span>
<span>    statistics <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>pbody_mrna_translation_index</span><span class='op'>$</span><span class='va'>mrna</span>,</span>
<span>    xlab <span class='op'>=</span> <span class='st'>"t"</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>j</span>,</span>
<span>    sub <span class='op'>=</span> <span class='st'>"'mRNA binding protein' genes"</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/barcodeplot.html'>barcodeplot</a></span><span class='op'>(</span></span>
<span>    statistics <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>t</span><span class='op'>[</span>, <span class='va'>j</span><span class='op'>]</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>pbody_mrna_translation_index</span><span class='op'>$</span><span class='va'>translation</span>,</span>
<span>    xlab <span class='op'>=</span> <span class='st'>"t"</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>j</span>,</span>
<span>    sub <span class='op'>=</span> <span class='st'>"'Translation' genes"</span><span class='op'>)</span></span>
<span>  <span class='co'># NOTE: fry() is a self-contained gene set test.</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/limma/man/roast.html'>fry</a></span><span class='op'>(</span></span>
<span>    y <span class='op'>=</span> <span class='va'>cfit</span><span class='op'>$</span><span class='va'>EList</span>,</span>
<span>    index <span class='op'>=</span> <span class='va'>pbody_mrna_translation_index</span>,</span>
<span>    design <span class='op'>=</span> <span class='va'>design</span>,</span>
<span>    contrast <span class='op'>=</span> <span class='va'>cm</span><span class='op'>[</span>, <span class='va'>j</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span><span class='op'>)</span></span>
<span><span class='op'>}</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>pdf 
  3 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>l_of_fry</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>cfit</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fry_pbody_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>rbind</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>l_of_fry</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>fry</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>fry</span><span class='op'>[</span><span class='st'>"pbody"</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>fry_mrna_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>rbind</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>l_of_fry</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>fry</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>fry</span><span class='op'>[</span><span class='st'>"mrna"</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>fry_translation_df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/do.call.html'>do.call</a></span><span class='op'>(</span></span>
<span>  <span class='va'>rbind</span>,</span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>l_of_fry</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>fry</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>fry</span><span class='op'>[</span><span class='st'>"translation"</span>, , drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># TODO: Look at the 'most significant' comparisons; discuss with Danu.</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_pbody_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_pbody_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_pbody_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                              NGenes Direction       PValue
WT.Day_9_vs_WT.Day_6              33      Down 6.567433e-22
GID1KO.Day_9_vs_GID1KO.Day_6      33      Down 6.446252e-14
GID7KO.Day_9_vs_GID7KO.Day_6      33      Down 2.097041e-13
GID8KO.Day_9_vs_GID8KO.Day_6      33      Down 2.386200e-08
GID1KO.Day_12_vs_GID1KO.Day_9     33      Down 6.196865e-08
GID2KO.Day_9_vs_GID2KO.Day_6      33      Down 1.378813e-07
                                       FDR PValue.Mixed    FDR.Mixed
WT.Day_9_vs_WT.Day_6          9.851149e-22 3.280648e-33 3.280648e-33
GID1KO.Day_9_vs_GID1KO.Day_6  9.669378e-14 5.379844e-20 5.379844e-20
GID7KO.Day_9_vs_GID7KO.Day_6  3.145561e-13 7.890486e-10 7.890486e-10
GID8KO.Day_9_vs_GID8KO.Day_6  3.579299e-08 2.392423e-03 2.392423e-03
GID1KO.Day_12_vs_GID1KO.Day_9 9.295298e-08 9.522255e-04 9.522255e-04
GID2KO.Day_9_vs_GID2KO.Day_6  2.068219e-07 2.165576e-04 2.165576e-04</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_pbody_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_pbody_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_pbody_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                                                                           NGenes
KOs_except_GID1.Day_9_vs_WT.Day_9                                              33
KOs.Day_9_vs_WT.Day_9                                                          33
KOs_except_GID9.Day_9_vs_WT.Day_9                                              33
GID2KO.Day_9_vs_WT.Day_9                                                       33
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)     33
GID9KO.Day_9_vs_WT.Day_9                                                       33
                                                                           Direction
KOs_except_GID1.Day_9_vs_WT.Day_9                                                 Up
KOs.Day_9_vs_WT.Day_9                                                             Up
KOs_except_GID9.Day_9_vs_WT.Day_9                                                 Up
GID2KO.Day_9_vs_WT.Day_9                                                          Up
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6)        Up
GID9KO.Day_9_vs_WT.Day_9                                                          Up
                                                                                 PValue
KOs_except_GID1.Day_9_vs_WT.Day_9                                          1.204292e-08
KOs.Day_9_vs_WT.Day_9                                                      3.624714e-08
KOs_except_GID9.Day_9_vs_WT.Day_9                                          1.082827e-07
GID2KO.Day_9_vs_WT.Day_9                                                   3.925421e-07
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6) 4.962250e-07
GID9KO.Day_9_vs_WT.Day_9                                                   1.205738e-06
                                                                                    FDR
KOs_except_GID1.Day_9_vs_WT.Day_9                                          1.204292e-08
KOs.Day_9_vs_WT.Day_9                                                      3.624714e-08
KOs_except_GID9.Day_9_vs_WT.Day_9                                          1.082827e-07
GID2KO.Day_9_vs_WT.Day_9                                                   3.925421e-07
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6) 7.443374e-07
GID9KO.Day_9_vs_WT.Day_9                                                   1.205738e-06
                                                                           PValue.Mixed
KOs_except_GID1.Day_9_vs_WT.Day_9                                          2.516314e-38
KOs.Day_9_vs_WT.Day_9                                                      1.618266e-36
KOs_except_GID9.Day_9_vs_WT.Day_9                                          5.737383e-34
GID2KO.Day_9_vs_WT.Day_9                                                   8.991059e-24
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6) 1.309654e-05
GID9KO.Day_9_vs_WT.Day_9                                                   9.470849e-23
                                                                              FDR.Mixed
KOs_except_GID1.Day_9_vs_WT.Day_9                                          2.516314e-38
KOs.Day_9_vs_WT.Day_9                                                      1.618266e-36
KOs_except_GID9.Day_9_vs_WT.Day_9                                          5.737383e-34
GID2KO.Day_9_vs_WT.Day_9                                                   8.991059e-24
(KOs_except_GID1.Day_9_vs_KOs_except_GID1.Day_6)_vs_(WT.Day_9_vs_WT.Day_6) 1.309654e-05
GID9KO.Day_9_vs_WT.Day_9                                                   9.470849e-23</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_mrna_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_mrna_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_mrna_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                              NGenes Direction       PValue
WT.Day_9_vs_WT.Day_6             149      Down 3.587504e-20
GID1KO.Day_9_vs_GID1KO.Day_6     149      Down 1.712708e-13
GID7KO.Day_9_vs_GID7KO.Day_6     149      Down 5.141374e-09
GID1KO.Day_12_vs_GID1KO.Day_9    149      Down 5.837929e-07
GID2KO.Day_12_vs_GID2KO.Day_9    149      Down 1.277433e-06
GID9KO.Day_9_vs_GID9KO.Day_6     149      Down 1.069809e-05
                                       FDR  PValue.Mixed
WT.Day_9_vs_WT.Day_6          3.587504e-20 7.270251e-209
GID1KO.Day_9_vs_GID1KO.Day_6  1.712708e-13  5.684948e-58
GID7KO.Day_9_vs_GID7KO.Day_6  5.141374e-09  8.125954e-28
GID1KO.Day_12_vs_GID1KO.Day_9 5.837929e-07  1.298659e-42
GID2KO.Day_12_vs_GID2KO.Day_9 1.916149e-06  5.100376e-19
GID9KO.Day_9_vs_GID9KO.Day_6  1.155223e-05  1.751322e-19
                                  FDR.Mixed
WT.Day_9_vs_WT.Day_6          2.181075e-208
GID1KO.Day_9_vs_GID1KO.Day_6   8.527422e-58
GID7KO.Day_9_vs_GID7KO.Day_6   1.218893e-27
GID1KO.Day_12_vs_GID1KO.Day_9  3.895977e-42
GID2KO.Day_12_vs_GID2KO.Day_9  7.650563e-19
GID9KO.Day_9_vs_GID9KO.Day_6   2.626983e-19</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_mrna_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_mrna_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_mrna_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                                  NGenes Direction       PValue
GID2KO.Day_6_vs_GID2KO.Day_3         149        Up 5.429119e-20
GID2KO.Day_9_vs_WT.Day_9             149        Up 4.617663e-13
WT.Day_6_vs_WT.Day_3                 149        Up 6.033073e-13
KOs_except_GID1.Day_9_vs_WT.Day_9    149        Up 1.905592e-12
GID9KO.Day_6_vs_GID9KO.Day_3         149        Up 4.489173e-12
GID9KO.Day_9_vs_WT.Day_9             149        Up 1.002357e-11
                                           FDR  PValue.Mixed
GID2KO.Day_6_vs_GID2KO.Day_3      8.143679e-20 2.038586e-166
GID2KO.Day_9_vs_WT.Day_9          6.926494e-13 2.053172e-211
WT.Day_6_vs_WT.Day_3              9.049609e-13 2.853976e-210
KOs_except_GID1.Day_9_vs_WT.Day_9 2.858388e-12 8.084913e-249
GID9KO.Day_6_vs_GID9KO.Day_3      1.346752e-11 1.840460e-188
GID9KO.Day_9_vs_WT.Day_9          3.007072e-11 4.234844e-204
                                      FDR.Mixed
GID2KO.Day_6_vs_GID2KO.Day_3      6.115757e-166
GID2KO.Day_9_vs_WT.Day_9          6.159515e-211
WT.Day_6_vs_WT.Day_3              8.561927e-210
KOs_except_GID1.Day_9_vs_WT.Day_9 2.425474e-248
GID9KO.Day_6_vs_GID9KO.Day_3      5.521381e-188
GID9KO.Day_9_vs_WT.Day_9          1.270453e-203</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_translation_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_translation_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_translation_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                             NGenes Direction       PValue
GID2KO.Day_6_vs_GID2KO.Day_3    107      Down 2.035049e-34
GID8KO.Day_6_vs_GID8KO.Day_3    107      Down 3.571972e-33
GID1KO.Day_6_vs_GID1KO.Day_3    107      Down 1.223122e-32
WT.Day_6_vs_WT.Day_3            107      Down 7.078788e-32
GID7KO.Day_6_vs_GID7KO.Day_3    107      Down 2.154978e-30
WT.Day_9_vs_WT.Day_6            107      Down 9.391852e-24
                                      FDR  PValue.Mixed     FDR.Mixed
GID2KO.Day_6_vs_GID2KO.Day_3 6.105146e-34 4.731066e-158 7.096600e-158
GID8KO.Day_6_vs_GID8KO.Day_3 1.071592e-32 4.777195e-177 7.165792e-177
GID1KO.Day_6_vs_GID1KO.Day_3 3.669365e-32 3.902120e-190 5.853180e-190
WT.Day_6_vs_WT.Day_3         2.123636e-31 4.531154e-174 6.796731e-174
GID7KO.Day_6_vs_GID7KO.Day_3 6.464933e-30 1.195963e-182 1.793944e-182
WT.Day_9_vs_WT.Day_6         2.817556e-23 3.347311e-131 5.020967e-131</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_translation_df</span><span class='op'>[</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span></span>
<span>      <span class='va'>fry_translation_df</span><span class='op'>$</span><span class='va'>Direction</span>,</span>
<span>      <span class='va'>fry_translation_df</span><span class='op'>$</span><span class='va'>FDR</span>,</span>
<span>      decreasing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>TRUE</span>, <span class='cn'>FALSE</span><span class='op'>)</span>,</span>
<span>      method <span class='op'>=</span> <span class='st'>"radix"</span><span class='op'>)</span>, <span class='op'>]</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                                                         NGenes
KOs_except_GID1.Day_9_vs_WT.Day_9                           107
GID2KO.Day_9_vs_WT.Day_9                                    107
KOs.Day_9_vs_WT.Day_9                                       107
KOs_except_GID9.Day_9_vs_WT.Day_9                           107
GID7KO.Day_9_vs_WT.Day_9                                    107
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)    107
                                                         Direction
KOs_except_GID1.Day_9_vs_WT.Day_9                               Up
GID2KO.Day_9_vs_WT.Day_9                                        Up
KOs.Day_9_vs_WT.Day_9                                           Up
KOs_except_GID9.Day_9_vs_WT.Day_9                               Up
GID7KO.Day_9_vs_WT.Day_9                                        Up
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)        Up
                                                               PValue
KOs_except_GID1.Day_9_vs_WT.Day_9                        8.076606e-15
GID2KO.Day_9_vs_WT.Day_9                                 4.448426e-13
KOs.Day_9_vs_WT.Day_9                                    2.967925e-13
KOs_except_GID9.Day_9_vs_WT.Day_9                        3.406518e-13
GID7KO.Day_9_vs_WT.Day_9                                 6.791780e-12
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3) 7.318632e-11
                                                                  FDR
KOs_except_GID1.Day_9_vs_WT.Day_9                        2.422982e-14
GID2KO.Day_9_vs_WT.Day_9                                 6.926494e-13
KOs.Day_9_vs_WT.Day_9                                    8.903776e-13
KOs_except_GID9.Day_9_vs_WT.Day_9                        1.021955e-12
GID7KO.Day_9_vs_WT.Day_9                                 2.037534e-11
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3) 2.195590e-10
                                                          PValue.Mixed
KOs_except_GID1.Day_9_vs_WT.Day_9                        3.421571e-150
GID2KO.Day_9_vs_WT.Day_9                                  2.445747e-77
KOs.Day_9_vs_WT.Day_9                                    1.184129e-151
KOs_except_GID9.Day_9_vs_WT.Day_9                        5.502438e-141
GID7KO.Day_9_vs_WT.Day_9                                  2.577601e-65
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)  2.113598e-11
                                                             FDR.Mixed
KOs_except_GID1.Day_9_vs_WT.Day_9                        5.132356e-150
GID2KO.Day_9_vs_WT.Day_9                                  3.668620e-77
KOs.Day_9_vs_WT.Day_9                                    1.776193e-151
KOs_except_GID9.Day_9_vs_WT.Day_9                        8.253657e-141
GID7KO.Day_9_vs_WT.Day_9                                  3.866401e-65
(GID9KO.Day_6_vs_GID9KO.Day_3)_vs_(WT.Day_6_vs_WT.Day_3)  6.340793e-11</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_pbody_df</span>,</span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Pbody_mRNA_translation"</span>, <span class='st'>"Processing_body_genes.fry.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_mrna_df</span>,</span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Pbody_mRNA_translation"</span>, <span class='st'>"mRNA_binding_protein_genes.fry.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.csv</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fry_translation_df</span>,</span>
<span>  <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"Pbody_mRNA_translation"</span>, <span class='st'>"Translation_genes.fry.csv"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Time course analysis ---------------------------------------------------------</span></span>
<span></span>
<span><span class='va'>X</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/splines/ns.html'>ns</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/integer.html'>as.integer</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span><span class='op'>)</span>, df <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='va'>Group</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/relevel.html'>relevel</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span>, <span class='st'>"WT"</span><span class='op'>)</span></span>
<span><span class='va'>design_tc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/model.matrix.html'>model.matrix</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>Group</span> <span class='op'>*</span> <span class='va'>X</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>design_tc</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>sub</a></span><span class='op'>(</span><span class='st'>"Group"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>design_tc</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>fit_tc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/edgeR/man/voomLmFit.html'>voomLmFit</a></span><span class='op'>(</span></span>
<span>  <span class='va'>y</span>,</span>
<span>  <span class='va'>design_tc</span>,</span>
<span>  block <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line_rep</span>,</span>
<span>  sample.weights <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>  plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='va'>fit_tc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/ebayes.html'>eBayes</a></span><span class='op'>(</span><span class='va'>fit_tc</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Outputs of time course analysis ----------------------------------------------</span></span>
<span></span>
<span><span class='co'># Summarise the number of DEGs in each comparison</span></span>
<span><span class='va'>tt_gid1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fit_tc</span>,</span>
<span>  coef <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GID1KO:X1"</span>, <span class='st'>"GID1KO:X2"</span>, <span class='st'>"GID1KO:X3"</span><span class='op'>)</span>,</span>
<span>  number <span class='op'>=</span> <span class='cn'>Inf</span>,</span>
<span>  p.value <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  sort.by <span class='op'>=</span> <span class='st'>"F"</span><span class='op'>)</span></span>
<span><span class='va'>tt_gid2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fit_tc</span>,</span>
<span>  coef <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GID2KO:X1"</span>, <span class='st'>"GID2KO:X2"</span>, <span class='st'>"GID2KO:X3"</span><span class='op'>)</span>,</span>
<span>  number <span class='op'>=</span> <span class='cn'>Inf</span>,</span>
<span>  p.value <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  sort.by <span class='op'>=</span> <span class='st'>"F"</span><span class='op'>)</span></span>
<span><span class='va'>tt_gid7</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fit_tc</span>,</span>
<span>  coef <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GID7KO:X1"</span>, <span class='st'>"GID7KO:X2"</span>, <span class='st'>"GID7KO:X3"</span><span class='op'>)</span>,</span>
<span>  number <span class='op'>=</span> <span class='cn'>Inf</span>,</span>
<span>  p.value <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  sort.by <span class='op'>=</span> <span class='st'>"F"</span><span class='op'>)</span></span>
<span><span class='va'>tt_gid8</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fit_tc</span>,</span>
<span>  coef <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GID8KO:X1"</span>, <span class='st'>"GID8KO:X2"</span>, <span class='st'>"GID8KO:X3"</span><span class='op'>)</span>,</span>
<span>  number <span class='op'>=</span> <span class='cn'>Inf</span>,</span>
<span>  p.value <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  sort.by <span class='op'>=</span> <span class='st'>"F"</span><span class='op'>)</span></span>
<span><span class='va'>tt_gid9</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fit_tc</span>,</span>
<span>  coef <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"GID9KO:X1"</span>, <span class='st'>"GID9KO:X2"</span>, <span class='st'>"GID9KO:X3"</span><span class='op'>)</span>,</span>
<span>  number <span class='op'>=</span> <span class='cn'>Inf</span>,</span>
<span>  p.value <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  sort.by <span class='op'>=</span> <span class='st'>"F"</span><span class='op'>)</span></span>
<span><span class='co'># NOTE: This is an ANOVA-like test.</span></span>
<span><span class='va'>tt_any_ko</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/limma/man/toptable.html'>topTable</a></span><span class='op'>(</span></span>
<span>  <span class='va'>fit_tc</span>,</span>
<span>  coef <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"GID1KO:X1"</span>, <span class='st'>"GID1KO:X2"</span>, <span class='st'>"GID1KO:X3"</span>,</span>
<span>    <span class='st'>"GID2KO:X1"</span>, <span class='st'>"GID2KO:X2"</span>, <span class='st'>"GID2KO:X3"</span>,</span>
<span>    <span class='st'>"GID7KO:X1"</span>, <span class='st'>"GID7KO:X2"</span>, <span class='st'>"GID7KO:X3"</span>,</span>
<span>    <span class='st'>"GID8KO:X1"</span>, <span class='st'>"GID8KO:X2"</span>, <span class='st'>"GID8KO:X3"</span>,</span>
<span>    <span class='st'>"GID9KO:X1"</span>, <span class='st'>"GID9KO:X2"</span>, <span class='st'>"GID9KO:X3"</span><span class='op'>)</span>,</span>
<span>  number <span class='op'>=</span> <span class='cn'>Inf</span>,</span>
<span>  p.value <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>  sort.by <span class='op'>=</span> <span class='st'>"F"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>  Sig <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid1</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid2</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid7</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid8</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid9</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_any_ko</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  NotSig <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid1</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid2</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid7</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid8</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_gid9</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>tt_any_ko</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&gt;=</span> <span class='fl'>0.05</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>  row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='st'>"GID1KO_vs_WT"</span>, <span class='st'>"GID2KO_vs_WT"</span>, <span class='st'>"GID7KO_vs_WT"</span>,</span>
<span>    <span class='st'>"GID8KO_vs_WT"</span>, <span class='st'>"GID9KO_vs_WT"</span>, <span class='st'>"any_KO_vs_WT"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>              Sig NotSig
GID1KO_vs_WT 1996   3317
GID2KO_vs_WT 2439   2874
GID7KO_vs_WT 2141   3172
GID8KO_vs_WT 2295   3018
GID9KO_vs_WT 2551   2762
any_KO_vs_WT 2965   2348</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Plots</span></span>
<span><span class='va'>lcpm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/SingleCellExperiment/man/assays.html'>cpm</a></span><span class='op'>(</span><span class='va'>y</span>, log <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"timecourse"</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/pdf.html'>pdf</a></span><span class='op'>(</span><span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span><span class='st'>"output"</span>, <span class='st'>"timecourse"</span>, <span class='st'>"any_KO_vs_WT.pdf"</span><span class='op'>)</span>, width <span class='op'>=</span> <span class='fl'>9</span>, height <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>g</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>tt_any_ko</span><span class='op'>)</span><span class='op'>[</span><span class='va'>tt_any_ko</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='fl'>0.05</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/message.html'>message</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span></span>
<span>  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span></span>
<span>    data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>lcpm <span class='op'>=</span> <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>g</span>, <span class='op'>]</span><span class='op'>)</span>, <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>)</span>,</span>
<span>    mapping <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>timepoint</span>, y <span class='op'>=</span> <span class='va'>lcpm</span>, group <span class='op'>=</span> <span class='va'>cell_line_rep</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>timepoint</span>, y <span class='op'>=</span> <span class='va'>lcpm</span>, group <span class='op'>=</span> <span class='va'>cell_line</span>, colour <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>,</span>
<span>      se <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>      lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_colour_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>fill <span class='op'>=</span> <span class='va'>group</span>, colour <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>, shape <span class='op'>=</span> <span class='fl'>21</span>, size <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='va'>cell_line</span><span class='op'>)</span>, alpha <span class='op'>=</span> <span class='fl'>0.5</span>, lty <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>cell_line</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='va'>g</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"none"</span>, fill <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkelab.org/cowplot/reference/theme_cowplot.html'>theme_cowplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://wilkelab.org/cowplot/reference/panel_border.html'>panel_border</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>45</span>, vjust <span class='op'>=</span> <span class='fl'>1</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/grDevices/dev.html'>dev.off</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>pdf 
  3 </code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># TODO: cutree_rows = ?</span></span>
<span><span class='co'># TODO: More stringent FDR cutoff for gene selection?</span></span>
<span><span class='va'>timeCourseHeatmaps</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>tt</span>, <span class='va'>n</span>, <span class='va'>cutree_rows</span> <span class='op'>=</span> <span class='fl'>6</span>, <span class='va'>FDR</span> <span class='op'>=</span> <span class='fl'>0.05</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>g</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>tt</span><span class='op'>[</span><span class='va'>tt</span><span class='op'>$</span><span class='va'>adj.P.Val</span> <span class='op'>&lt;</span> <span class='va'>FDR</span>, <span class='op'>]</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='co'># 1. Samples ordered by `group`.</span></span>
<span>  <span class='va'>hm</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>g</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>    scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>    fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>n</span>,</span>
<span>    annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span><span class='op'>)</span>,</span>
<span>    angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>    treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    height <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    cutree_rows <span class='op'>=</span> <span class='va'>cutree_rows</span>,</span>
<span>    show_rownames <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    silent <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span>  <span class='va'>gc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></span><span class='op'>(</span><span class='va'>hm</span><span class='op'>$</span><span class='va'>tree_row</span>, k <span class='op'>=</span> <span class='va'>cutree_rows</span><span class='op'>)</span></span>
<span>  <span class='va'>gc_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.colors</a></span><span class='op'>(</span><span class='va'>cutree_rows</span>, <span class='st'>"Okabe-Ito"</span><span class='op'>)</span>,</span>
<span>    <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>cutree_rows</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>g</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>    scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>    fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='st'>"group"</span>, drop <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>]</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>n</span>,</span>
<span>    annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>group <span class='op'>=</span> <span class='va'>group_colours</span>, cluster <span class='op'>=</span> <span class='va'>gc_colours</span><span class='op'>)</span>,</span>
<span>    angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>    treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"output"</span>,</span>
<span>      <span class='st'>"timecourse"</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='st'>".time_course_heatmap.samples_ordered.pdf"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    height <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    cutree_rows <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    show_rownames <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    annotation_row <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>cluster <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gc</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gc</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='co'># 2. Samples clustered by expression pattern.</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>g</span>, <span class='op'>]</span>,</span>
<span>    scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>    color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>    fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>    fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    annotation_col <span class='op'>=</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>    main <span class='op'>=</span> <span class='va'>n</span>,</span>
<span>    annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>      cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span>,</span>
<span>      timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span>,</span>
<span>      cluster <span class='op'>=</span> <span class='va'>gc_colours</span><span class='op'>)</span>,</span>
<span>    angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>    treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>    cluster_cols <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span>    filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>      <span class='st'>"output"</span>,</span>
<span>      <span class='st'>"timecourse"</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='st'>".time_course_heatmap.samples_clustered.pdf"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>    width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    height <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>    cutree_rows <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>    show_rownames <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>    annotation_row <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>cluster <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gc</span><span class='op'>)</span>, row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gc</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span>  <span class='co'># 3. Samples subsetted to those involved in the comparison and then ordered</span></span>
<span>  <span class='co'>#    by `group`.</span></span>
<span>  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>n</span> <span class='op'>!=</span> <span class='st'>"any_KO_vs_WT"</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>cts</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/strsplit.html'>strsplit</a></span><span class='op'>(</span><span class='va'>n</span>, <span class='st'>"_"</span><span class='op'>)</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span></span>
<span>    <span class='va'>jj</span> <span class='op'>&lt;-</span> <span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='va'>cts</span></span>
<span>    <span class='va'>hm2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>      <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>g</span>, <span class='va'>jj</span><span class='op'>]</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>[</span><span class='va'>jj</span><span class='op'>]</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>      scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>      color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>      fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>      fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>      fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>      annotation_col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span><span class='va'>jj</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>      main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\_vs\\_"</span>, <span class='st'>" vs. "</span>, <span class='va'>n</span><span class='op'>)</span>,</span>
<span>      angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>      treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>      treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>      cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>      width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>      height <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>      cutree_rows <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>      show_rownames <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>      silent <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span>    <span class='va'>gc2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/cutree.html'>cutree</a></span><span class='op'>(</span><span class='va'>hm2</span><span class='op'>$</span><span class='va'>tree_row</span>, k <span class='op'>=</span> <span class='va'>cutree_rows</span><span class='op'>)</span></span>
<span>    <span class='va'>gc2_colours</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/setNames.html'>setNames</a></span><span class='op'>(</span></span>
<span>      <span class='fu'><a href='https://rdrr.io/r/grDevices/palette.html'>palette.colors</a></span><span class='op'>(</span><span class='va'>cutree_rows</span>, <span class='st'>"Dark2"</span><span class='op'>)</span>,</span>
<span>      <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_len</a></span><span class='op'>(</span><span class='va'>cutree_rows</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/pheatmap/man/pheatmap.html'>pheatmap</a></span><span class='op'>(</span></span>
<span>      <span class='va'>lcpm</span><span class='op'>[</span><span class='va'>g</span>, <span class='va'>jj</span><span class='op'>]</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>group</span><span class='op'>[</span><span class='va'>jj</span><span class='op'>]</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>      scale <span class='op'>=</span> <span class='st'>"row"</span>,</span>
<span>      color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grDevices/colorRamp.html'>colorRampPalette</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"blue"</span>,<span class='st'>"white"</span>,<span class='st'>"red"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>(</span><span class='fl'>100</span><span class='op'>)</span>,</span>
<span>      fontsize_row <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>      fontsize_col <span class='op'>=</span> <span class='fl'>5</span>,</span>
<span>      fontsize <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>      annotation_col <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>[</span><span class='va'>jj</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"timepoint"</span>, <span class='st'>"cell_line"</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>      main <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span><span class='op'>(</span><span class='st'>"\\_vs\\_"</span>, <span class='st'>" vs. "</span>, <span class='va'>n</span><span class='op'>)</span>,</span>
<span>      annotation_colors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span></span>
<span>        cell_line <span class='op'>=</span> <span class='va'>cell_line_colours</span><span class='op'>[</span></span>
<span>          <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>cell_line</span><span class='op'>[</span><span class='va'>jj</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>        timepoint <span class='op'>=</span> <span class='va'>timepoint_colours</span><span class='op'>[</span></span>
<span>          <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>$</span><span class='va'>samples</span><span class='op'>$</span><span class='va'>timepoint</span><span class='op'>[</span><span class='va'>jj</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>]</span>,</span>
<span>        cluster2 <span class='op'>=</span> <span class='va'>gc2_colours</span><span class='op'>)</span>,</span>
<span>      angle_col <span class='op'>=</span> <span class='fl'>45</span>,</span>
<span>      treeheight_row <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>      treeheight_col <span class='op'>=</span> <span class='fl'>30</span>,</span>
<span>      cluster_cols <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>      filename <span class='op'>=</span> <span class='fu'><a href='https://here.r-lib.org//reference/here.html'>here</a></span><span class='op'>(</span></span>
<span>        <span class='st'>"output"</span>,</span>
<span>        <span class='st'>"timecourse"</span>,</span>
<span>        <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span></span>
<span>          <span class='va'>n</span>,</span>
<span>          <span class='st'>".time_course_heatmap.samples_ordered.only_relevant_samples.pdf"</span><span class='op'>)</span><span class='op'>)</span>,</span>
<span>      width <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>      height <span class='op'>=</span> <span class='fl'>12</span>,</span>
<span>      cutree_rows <span class='op'>=</span> <span class='fl'>6</span>,</span>
<span>      show_rownames <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span>      annotation_row <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span></span>
<span>        cluster2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>gc2</span><span class='op'>)</span>,</span>
<span>        row.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gc2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span>    <span class='va'>val</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>gc <span class='op'>=</span> <span class='va'>gc</span>, gc2 <span class='op'>=</span> <span class='va'>gc2</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span></span>
<span>    <span class='va'>val</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>gc <span class='op'>=</span> <span class='va'>gc</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span>  <span class='va'>val</span></span>
<span><span class='op'>}</span></span>
<span><span class='va'>gcs_gid1</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseHeatmaps</span><span class='op'>(</span><span class='va'>tt_gid1</span>, <span class='st'>"GID1KO_vs_WT"</span><span class='op'>)</span></span>
<span><span class='va'>gcs_gid2</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseHeatmaps</span><span class='op'>(</span><span class='va'>tt_gid2</span>, <span class='st'>"GID2KO_vs_WT"</span><span class='op'>)</span></span>
<span><span class='va'>gcs_gid7</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseHeatmaps</span><span class='op'>(</span><span class='va'>tt_gid7</span>, <span class='st'>"GID7KO_vs_WT"</span><span class='op'>)</span></span>
<span><span class='va'>gcs_gid8</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseHeatmaps</span><span class='op'>(</span><span class='va'>tt_gid8</span>, <span class='st'>"GID8KO_vs_WT"</span><span class='op'>)</span></span>
<span><span class='va'>gcs_gid9</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseHeatmaps</span><span class='op'>(</span><span class='va'>tt_gid9</span>, <span class='st'>"GID9KO_vs_WT"</span><span class='op'>)</span></span>
<span><span class='va'>gcs_any_ko</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseHeatmaps</span><span class='op'>(</span><span class='va'>tt_any_ko</span>, <span class='st'>"any_KO_vs_WT"</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># Gene set analyses of timecourse data -----------------------------------------</span></span>
<span></span>
<span><span class='co'># NOTE: Relies on output of timeCourseHeatmaps()</span></span>
<span><span class='va'>timeCourseGO</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>gc</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>val</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>gc</span><span class='op'>)</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>cl</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='fu'><a href='https://rdrr.io/pkg/limma/man/goana.html'>kegga.default</a></span><span class='op'>(</span></span>
<span>      de <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>gc</span><span class='op'>[</span><span class='va'>gc</span> <span class='op'>==</span> <span class='va'>cl</span><span class='op'>]</span><span class='op'>)</span>,</span>
<span>      universe <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>fit_tc</span><span class='op'>$</span><span class='va'>genes</span><span class='op'>$</span><span class='va'>GENEID</span><span class='op'>)</span>,</span>
<span>      gene.pathway <span class='op'>=</span> <span class='va'>gene.pathway</span>,</span>
<span>      pathway.names <span class='op'>=</span> <span class='va'>pathway.names</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>val</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sort.html'>sort</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/unique.html'>unique</a></span><span class='op'>(</span><span class='va'>gc</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='va'>val</span></span>
<span><span class='op'>}</span></span>
<span><span class='co'># TODO: gc or gc2?</span></span>
<span><span class='va'>l_of_keg_gid1</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseGO</span><span class='op'>(</span><span class='va'>gcs_gid1</span><span class='op'>$</span><span class='va'>gc2</span><span class='op'>)</span></span>
<span><span class='va'>l_of_keg_gid2</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseGO</span><span class='op'>(</span><span class='va'>gcs_gid2</span><span class='op'>$</span><span class='va'>gc2</span><span class='op'>)</span></span>
<span><span class='va'>l_of_keg_gid7</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseGO</span><span class='op'>(</span><span class='va'>gcs_gid7</span><span class='op'>$</span><span class='va'>gc2</span><span class='op'>)</span></span>
<span><span class='va'>l_of_keg_gid8</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseGO</span><span class='op'>(</span><span class='va'>gcs_gid8</span><span class='op'>$</span><span class='va'>gc2</span><span class='op'>)</span></span>
<span><span class='va'>l_of_keg_gid9</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseGO</span><span class='op'>(</span><span class='va'>gcs_gid9</span><span class='op'>$</span><span class='va'>gc2</span><span class='op'>)</span></span>
<span><span class='va'>l_of_keg_any_ko</span> <span class='op'>&lt;-</span> <span class='fu'>timeCourseGO</span><span class='op'>(</span><span class='va'>gcs_any_ko</span><span class='op'>$</span><span class='va'>gc</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># An example of results</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/limma/man/topGO.html'>topKEGG</a></span><span class='op'>(</span><span class='va'>l_of_keg_any_ko</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, n <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span></span></code></pre>
</div>
</details>
<pre><code>                                        Pathway  N DE         P.DE
GO:0042575               DNA polymerase complex 11  6 2.347571e-05
GO:0003887 DNA-directed DNA polymerase activity 12  5 5.751971e-04
GO:0034061              DNA polymerase activity 13  5 8.859034e-04
GO:0005871                      kinesin complex  8  4 9.491505e-04
GO:0015631                      tubulin binding 42  9 1.118091e-03</code></pre>
<details>
<summary>
Show code
</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># TODO: Make CSVs of GO results; need to settle on a few other decisions (e.g,</span></span>
<span><span class='co'>#       clustering algorithm and number of clusters of gene patterns) before</span></span>
<span><span class='co'>#       its worth generating these.</span></span>
<span></span>
<span><span class='co'># TODOs ------------------------------------------------------------------------</span></span>
<span></span>
<span><span class='co'># - [ ] Is it possible to re-arrange the row dendograms (timecourse stuff) to</span></span>
<span><span class='co'>#       have the groups in the same order as the legend?</span></span>
<span><span class='co'># - [ ] To get exemplars of each cluster of timecourse genes, can use gc in</span></span>
<span><span class='co'>#       conjunction with the gene list (and then re-order by significance, if</span></span>
<span><span class='co'>#       necessary).</span></span>
<span><span class='co'># - [ ] If it's useful to highlight Lasonder and/or Guerreiro genes in</span></span>
<span><span class='co'>#       timecourse heatmap then need to include it in the above.</span></span></code></pre>
</div>
</details>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
